<!DOCTYPE html><head><title>LittleDarwin Aggregate Mutation Report</title> <style type='text/css'> body { font-family: "Carlito", "Calibri", "Helvetica Neue", sans-serif;}
                    .code { font-family: monospace; font-size: medium; }
                    .methodLine { background: white; }
                    .outsideLine { background: lightgray; } 
                    .tooltip { position: relative; display: inline-block; }
                    .tooltip .tooltiptext { visibility: hidden; display: block;
                        background-color: #006400; color: #ffffff; text-align: left;
                        border-radius: 0.3em; padding: 0.5em 0.5em; position: absolute; top: 125%; z-index: 200;}
                    .tooltip:hover .tooltiptext { visibility: visible; } .RelationalOperatorReplacement { background: #FFA07A; } .ArithmeticOperatorReplacementShortcut { background: #FF00FF; } .GenericTraditionalMutationOperator { background: #FFFFF0; } .ArithmeticOperatorReplacementBinary { background: #FFB6C1; } .ConditionalOperatorDeletion { background: #FFD700; } .NullifyInputVariable { background: #90EE90; } .ArithmeticOperatorReplacementUnary { background: #DDA0DD; } .NullifyReturnValue { background: #E0FFFF; } .AssignmentOperatorReplacementShortcut { background: #B0C4DE; } .NullifyObjectInitialization { background: #F08080; } .LogicalOperatorReplacement { background: #F0E68C; } .RemoveNullCheck { background: #ADD8E6; } .ConditionalOperatorReplacement { background: #87CEFA; } .ShiftOperatorReplacement { background: #9ACD32; } .RemoveMethod { background: #FF00D4; } </style></head><body><h1>LittleDarwin Aggregate Mutation Report</h1><p>Average Density: 0.48</p><div><pre class="code"><span class="outsideLine"><i>0001</i> /*                                                                                                                                  
</span><span class="outsideLine"><i>0002</i>  * Licensed to the Apache Software Foundation (ASF) under one or more                                                               
</span><span class="outsideLine"><i>0003</i>  * contributor license agreements.  See the NOTICE file distributed with                                                            
</span><span class="outsideLine"><i>0004</i>  * this work for additional information regarding copyright ownership.                                                              
</span><span class="outsideLine"><i>0005</i>  * The ASF licenses this file to You under the Apache License, Version 2.0                                                          
</span><span class="outsideLine"><i>0006</i>  * (the "License"); you may not use this file except in compliance with                                                             
</span><span class="outsideLine"><i>0007</i>  * the License.  You may obtain a copy of the License at                                                                            
</span><span class="outsideLine"><i>0008</i>  *                                                                                                                                  
</span><span class="outsideLine"><i>0009</i>  *      http://www.apache.org/licenses/LICENSE-2.0                                                                                  
</span><span class="outsideLine"><i>0010</i>  *                                                                                                                                  
</span><span class="outsideLine"><i>0011</i>  * Unless required by applicable law or agreed to in writing, software                                                              
</span><span class="outsideLine"><i>0012</i>  * distributed under the License is distributed on an "AS IS" BASIS,                                                                
</span><span class="outsideLine"><i>0013</i>  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                         
</span><span class="outsideLine"><i>0014</i>  * See the License for the specific language governing permissions and                                                              
</span><span class="outsideLine"><i>0015</i>  * limitations under the License.                                                                                                   
</span><span class="outsideLine"><i>0016</i>  */                                                                                                                                 
</span><span class="outsideLine"><i>0017</i> package org.apache.pdfbox.pdmodel;                                                                                                  
</span><span class="outsideLine"><i>0018</i>                                                                                                                                     
</span><span class="outsideLine"><i>0019</i> import java.awt.Point;                                                                                                              
</span><span class="outsideLine"><i>0020</i> import java.awt.image.DataBuffer;                                                                                                   
</span><span class="outsideLine"><i>0021</i> import java.awt.image.Raster;                                                                                                       
</span><span class="outsideLine"><i>0022</i> import java.awt.image.WritableRaster;                                                                                               
</span><span class="outsideLine"><i>0023</i> import java.io.BufferedOutputStream;                                                                                                
</span><span class="outsideLine"><i>0024</i> import java.io.Closeable;                                                                                                           
</span><span class="outsideLine"><i>0025</i> import java.io.File;                                                                                                                
</span><span class="outsideLine"><i>0026</i> import java.io.FileOutputStream;                                                                                                    
</span><span class="outsideLine"><i>0027</i> import java.io.IOException;                                                                                                         
</span><span class="outsideLine"><i>0028</i> import java.io.InputStream;                                                                                                         
</span><span class="outsideLine"><i>0029</i> import java.io.OutputStream;                                                                                                        
</span><span class="outsideLine"><i>0030</i> import java.util.ArrayList;                                                                                                         
</span><span class="outsideLine"><i>0031</i> import java.util.Arrays;                                                                                                            
</span><span class="outsideLine"><i>0032</i> import java.util.HashSet;                                                                                                           
</span><span class="outsideLine"><i>0033</i> import java.util.Iterator;                                                                                                          
</span><span class="outsideLine"><i>0034</i> import java.util.List;                                                                                                              
</span><span class="outsideLine"><i>0035</i> import java.util.Set;                                                                                                               
</span><span class="outsideLine"><i>0036</i> import org.apache.commons.logging.Log;                                                                                              
</span><span class="outsideLine"><i>0037</i> import org.apache.commons.logging.LogFactory;                                                                                       
</span><span class="outsideLine"><i>0038</i> import org.apache.fontbox.ttf.TrueTypeFont;                                                                                         
</span><span class="outsideLine"><i>0039</i> import org.apache.pdfbox.cos.COSArray;                                                                                              
</span><span class="outsideLine"><i>0040</i> import org.apache.pdfbox.cos.COSBase;                                                                                               
</span><span class="outsideLine"><i>0041</i> import org.apache.pdfbox.cos.COSDictionary;                                                                                         
</span><span class="outsideLine"><i>0042</i> import org.apache.pdfbox.cos.COSDocument;                                                                                           
</span><span class="outsideLine"><i>0043</i> import org.apache.pdfbox.cos.COSInteger;                                                                                            
</span><span class="outsideLine"><i>0044</i> import org.apache.pdfbox.cos.COSName;                                                                                               
</span><span class="outsideLine"><i>0045</i> import org.apache.pdfbox.cos.COSNumber;                                                                                             
</span><span class="outsideLine"><i>0046</i> import org.apache.pdfbox.cos.COSObject;                                                                                             
</span><span class="outsideLine"><i>0047</i> import org.apache.pdfbox.cos.COSUpdateInfo;                                                                                         
</span><span class="outsideLine"><i>0048</i> import org.apache.pdfbox.io.IOUtils;                                                                                                
</span><span class="outsideLine"><i>0049</i> import org.apache.pdfbox.io.MemoryUsageSetting;                                                                                     
</span><span class="outsideLine"><i>0050</i> import org.apache.pdfbox.io.RandomAccessBuffer;                                                                                     
</span><span class="outsideLine"><i>0051</i> import org.apache.pdfbox.io.RandomAccessBufferedFileInputStream;                                                                    
</span><span class="outsideLine"><i>0052</i> import org.apache.pdfbox.io.RandomAccessRead;                                                                                       
</span><span class="outsideLine"><i>0053</i> import org.apache.pdfbox.io.ScratchFile;                                                                                            
</span><span class="outsideLine"><i>0054</i> import org.apache.pdfbox.pdfparser.PDFParser;                                                                                       
</span><span class="outsideLine"><i>0055</i> import org.apache.pdfbox.pdfwriter.COSWriter;                                                                                       
</span><span class="outsideLine"><i>0056</i> import org.apache.pdfbox.pdmodel.common.COSArrayList;                                                                               
</span><span class="outsideLine"><i>0057</i> import org.apache.pdfbox.pdmodel.common.PDRectangle;                                                                                
</span><span class="outsideLine"><i>0058</i> import org.apache.pdfbox.pdmodel.common.PDStream;                                                                                   
</span><span class="outsideLine"><i>0059</i> import org.apache.pdfbox.pdmodel.encryption.AccessPermission;                                                                       
</span><span class="outsideLine"><i>0060</i> import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;                                                               
</span><span class="outsideLine"><i>0061</i> import org.apache.pdfbox.pdmodel.encryption.PDEncryption;                                                                           
</span><span class="outsideLine"><i>0062</i> import org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy;                                                                       
</span><span class="outsideLine"><i>0063</i> import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;                                                                        
</span><span class="outsideLine"><i>0064</i> import org.apache.pdfbox.pdmodel.encryption.SecurityHandlerFactory;                                                                 
</span><span class="outsideLine"><i>0065</i> import org.apache.pdfbox.pdmodel.font.PDFont;                                                                                       
</span><span class="outsideLine"><i>0066</i> import org.apache.pdfbox.pdmodel.graphics.color.PDDeviceRGB;                                                                        
</span><span class="outsideLine"><i>0067</i> import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotation;                                                               
</span><span class="outsideLine"><i>0068</i> import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotationWidget;                                                         
</span><span class="outsideLine"><i>0069</i> import org.apache.pdfbox.pdmodel.interactive.annotation.PDAppearanceDictionary;                                                     
</span><span class="outsideLine"><i>0070</i> import org.apache.pdfbox.pdmodel.interactive.annotation.PDAppearanceStream;                                                         
</span><span class="outsideLine"><i>0071</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.ExternalSigningSupport;                                               
</span><span class="outsideLine"><i>0072</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.PDSignature;                                                          
</span><span class="outsideLine"><i>0073</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.SignatureInterface;                                                   
</span><span class="outsideLine"><i>0074</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.SignatureOptions;                                                     
</span><span class="outsideLine"><i>0075</i> import org.apache.pdfbox.pdmodel.interactive.digitalsignature.SigningSupport;                                                       
</span><span class="outsideLine"><i>0076</i> import org.apache.pdfbox.pdmodel.interactive.form.PDAcroForm;                                                                       
</span><span class="outsideLine"><i>0077</i> import org.apache.pdfbox.pdmodel.interactive.form.PDField;                                                                          
</span><span class="outsideLine"><i>0078</i> import org.apache.pdfbox.pdmodel.interactive.form.PDSignatureField;                                                                 
</span><span class="outsideLine"><i>0079</i>                                                                                                                                     
</span><span class="outsideLine"><i>0080</i> /**                                                                                                                                 
</span><span class="outsideLine"><i>0081</i>  * This is the in-memory representation of the PDF document.                                                                        
</span><span class="outsideLine"><i>0082</i>  * The #close() method must be called once the document is no longer needed.                                                        
</span><span class="outsideLine"><i>0083</i>  *                                                                                                                                  
</span><span class="outsideLine"><i>0084</i>  * @author Ben Litchfield                                                                                                           
</span><span class="outsideLine"><i>0085</i>  */                                                                                                                                 
</span><span class="outsideLine"><i>0086</i> public class PDDocument implements Closeable                                                                                        
</span><span class="outsideLine"><i>0087</i> {                                                                                                                                   
</span><span class="outsideLine"><i>0088</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0089</i>      * For signing: large reserve byte range used as placeholder in the saved PDF until the actual                                  
</span><span class="outsideLine"><i>0090</i>      * length of the PDF is known. You'll need to fetch (with                                                                       
</span><span class="outsideLine"><i>0091</i>      * {@link PDSignature#getByteRange()} ) and reassign this yourself (with                                                        
</span><span class="outsideLine"><i>0092</i>      * {@link PDSignature#setByteRange(int[])} ) only if you call                                                                   
</span><span class="outsideLine"><i>0093</i>      * {@link #saveIncrementalForExternalSigning(java.io.OutputStream) saveIncrementalForExternalSigning()}                         
</span><span class="outsideLine"><i>0094</i>      * twice.                                                                                                                       
</span><span class="outsideLine"><i>0095</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0096</i>     private static final int[] RESERVE_BYTE_RANGE = new int[] { 0, 1000000000, 1000000000, 1000000000 };                            
</span><span class="outsideLine"><i>0097</i>                                                                                                                                     
</span><span class="outsideLine"><i>0098</i>     private static final Log LOG = LogFactory.getLog(PDDocument.class);                                                             
</span><span class="outsideLine"><i>0099</i>                                                                                                                                     
</span><span class="outsideLine"><i>0100</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0101</i>      * avoid concurrency issues with PDDeviceRGB and deadlock in COSNumber/COSInteger                                               
</span><span class="outsideLine"><i>0102</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0103</i>     static                                                                                                                          
</span><span class="outsideLine"><i>0104</i>     {                                                                                                                               
</span><span class="outsideLine"><i>0105</i>         try                                                                                                                         
</span><span class="outsideLine"><i>0106</i>         {                                                                                                                           
</span><span class="outsideLine"><i>0107</i>             WritableRaster raster = Raster.createBandedRaster(DataBuffer.TYPE_BYTE, 1, 1, 3, <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8550</span>new Point(0, 0)</span>);                      
</span><span class="outsideLine"><i>0108</i>             PDDeviceRGB.INSTANCE.toRGBImage(raster);                                                                                
</span><span class="outsideLine"><i>0109</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0110</i>         catch (IOException ex)                                                                                                      
</span><span class="outsideLine"><i>0111</i>         {                                                                                                                           
</span><span class="outsideLine"><i>0112</i>             LOG.debug("voodoo error", ex);                                                                                          
</span><span class="outsideLine"><i>0113</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0114</i>                                                                                                                                     
</span><span class="outsideLine"><i>0115</i>         try                                                                                                                         
</span><span class="outsideLine"><i>0116</i>         {                                                                                                                           
</span><span class="outsideLine"><i>0117</i>             COSNumber.get("0");                                                                                                     
</span><span class="outsideLine"><i>0118</i>             COSNumber.get("1");                                                                                                     
</span><span class="outsideLine"><i>0119</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0120</i>         catch (IOException ex)                                                                                                      
</span><span class="outsideLine"><i>0121</i>         {                                                                                                                           
</span><span class="outsideLine"><i>0122</i>             //                                                                                                                      
</span><span class="outsideLine"><i>0123</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0124</i>     }                                                                                                                               
</span><span class="outsideLine"><i>0125</i>                                                                                                                                     
</span><span class="outsideLine"><i>0126</i>     private final COSDocument document;                                                                                             
</span><span class="outsideLine"><i>0127</i>                                                                                                                                     
</span><span class="outsideLine"><i>0128</i>     // cached values                                                                                                                
</span><span class="outsideLine"><i>0129</i>     private PDDocumentInformation documentInformation;                                                                              
</span><span class="outsideLine"><i>0130</i>     private PDDocumentCatalog documentCatalog;                                                                                      
</span><span class="outsideLine"><i>0131</i>                                                                                                                                     
</span><span class="outsideLine"><i>0132</i>     // the encryption will be cached here. When the document is decrypted then                                                      
</span><span class="outsideLine"><i>0133</i>     // the COSDocument will not have an "Encrypt" dictionary anymore and this object must be used                                   
</span><span class="outsideLine"><i>0134</i>     private PDEncryption encryption;                                                                                                
</span><span class="outsideLine"><i>0135</i>                                                                                                                                     
</span><span class="outsideLine"><i>0136</i>     // holds a flag which tells us if we should remove all security from this documents.                                            
</span><span class="outsideLine"><i>0137</i>     private boolean allSecurityToBeRemoved;                                                                                         
</span><span class="outsideLine"><i>0138</i>                                                                                                                                     
</span><span class="outsideLine"><i>0139</i>     // keep tracking customized documentId for the trailer. If null, a new id will be generated                                     
</span><span class="outsideLine"><i>0140</i>     // this ID doesn't represent the actual documentId from the trailer                                                             
</span><span class="outsideLine"><i>0141</i>     private Long documentId;                                                                                                        
</span><span class="outsideLine"><i>0142</i>                                                                                                                                     
</span><span class="outsideLine"><i>0143</i>     // the pdf to be read                                                                                                           
</span><span class="outsideLine"><i>0144</i>     private final RandomAccessRead pdfSource;                                                                                       
</span><span class="outsideLine"><i>0145</i>                                                                                                                                     
</span><span class="outsideLine"><i>0146</i>     // the access permissions of the document                                                                                       
</span><span class="outsideLine"><i>0147</i>     private AccessPermission accessPermission;                                                                                      
</span><span class="outsideLine"><i>0148</i>                                                                                                                                     
</span><span class="outsideLine"><i>0149</i>     // fonts to subset before saving                                                                                                
</span><span class="outsideLine"><i>0150</i>     private final Set<PDFont> fontsToSubset = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3323</span>new HashSet<PDFont>()</span>;                                                                
</span><span class="outsideLine"><i>0151</i>                                                                                                                                     
</span><span class="outsideLine"><i>0152</i>     // fonts to close when closing document                                                                                         
</span><span class="outsideLine"><i>0153</i>     private final Set<TrueTypeFont> fontsToClose = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3326</span>new HashSet<TrueTypeFont>()</span>;                                                     
</span><span class="outsideLine"><i>0154</i>                                                                                                                                     
</span><span class="outsideLine"><i>0155</i>     // Signature interface                                                                                                          
</span><span class="outsideLine"><i>0156</i>     private SignatureInterface signInterface;                                                                                       
</span><span class="outsideLine"><i>0157</i>                                                                                                                                     
</span><span class="outsideLine"><i>0158</i>     // helper class used to create external signature                                                                               
</span><span class="outsideLine"><i>0159</i>     private SigningSupport signingSupport;                                                                                          
</span><span class="outsideLine"><i>0160</i>                                                                                                                                     
</span><span class="outsideLine"><i>0161</i>     // document-wide cached resources                                                                                               
</span><span class="outsideLine"><i>0162</i>     private ResourceCache resourceCache = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 3328</span>new DefaultResourceCache()</span>;                                                               
</span><span class="outsideLine"><i>0163</i>                                                                                                                                     
</span><span class="outsideLine"><i>0164</i>     // to make sure only one signature is added                                                                                     
</span><span class="outsideLine"><i>0165</i>     private boolean signatureAdded = false;                                                                                         
</span><span class="outsideLine"><i>0166</i>                                                                                                                                     
</span><span class="outsideLine"><i>0167</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0168</i>      * Creates an empty PDF document.                                                                                               
</span><span class="outsideLine"><i>0169</i>      * You need to add at least one page for the document to be valid.                                                              
</span><span class="outsideLine"><i>0170</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0171</i>     public PDDocument()                                                                                                             
</span><span class="methodLine"><i>0172</i>     {                                                                                                                               
</span><span class="methodLine"><i>0173</i>         this(MemoryUsageSetting.setupMainMemoryOnly());                                                                             
</span><span class="methodLine"><i>0174</i>     }                                                                                                                               
</span><span class="outsideLine"><i>0175</i>                                                                                                                                     
</span><span class="outsideLine"><i>0176</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0177</i>      * Creates an empty PDF document.                                                                                               
</span><span class="outsideLine"><i>0178</i>      * You need to add at least one page for the document to be valid.                                                              
</span><span class="outsideLine"><i>0179</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0180</i>      * @param memUsageSetting defines how memory is used for buffering PDF streams                                                  
</span><span class="outsideLine"><i>0181</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0182</i>     public PDDocument(MemoryUsageSetting memUsageSetting)                                                                           
</span><span class="methodLine"><i>0183</i>     {                                                                                                                               
</span><span class="methodLine"><i>0184</i>         ScratchFile scratchFile = null;                                                                                             
</span><span class="methodLine"><i>0185</i>         try                                                                                                                         
</span><span class="methodLine"><i>0186</i>         {                                                                                                                           
</span><span class="methodLine"><i>0187</i>             scratchFile = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7878</span>new ScratchFile(memUsageSetting)</span>;                                                                         
</span><span class="methodLine"><i>0188</i>         }                                                                                                                           
</span><span class="methodLine"><i>0189</i>         catch (IOException ioe)                                                                                                     
</span><span class="methodLine"><i>0190</i>         {                                                                                                                           
</span><span class="methodLine"><i>0191</i>             LOG.warn("Error initializing scratch file: " + ioe.getMessage() +                                                       
</span><span class="methodLine"><i>0192</i>                      ". Fall back to main memory usage only.");                                                                     
</span><span class="methodLine"><i>0193</i>             try                                                                                                                     
</span><span class="methodLine"><i>0194</i>             {                                                                                                                       
</span><span class="methodLine"><i>0195</i>                 scratchFile = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10013</span>new ScratchFile(MemoryUsageSetting.setupMainMemoryOnly())</span>;                                            
</span><span class="methodLine"><i>0196</i>             }                                                                                                                       
</span><span class="methodLine"><i>0197</i>             catch (IOException ioe2) {}                                                                                             
</span><span class="methodLine"><i>0198</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0199</i>                                                                                                                                     
</span><span class="methodLine"><i>0200</i>         document = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 5594</span>new COSDocument(scratchFile)</span>;                                                                                    
</span><span class="methodLine"><i>0201</i>         pdfSource = null;                                                                                                           
</span><span class="outsideLine"><i>0202</i>                                                                                                                                     
</span><span class="outsideLine"><i>0203</i>         // First we need a trailer                                                                                                  
</span><span class="methodLine"><i>0204</i>         COSDictionary trailer = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7241</span>new COSDictionary()</span>;                                                                                
</span><span class="methodLine"><i>0205</i>         document.setTrailer(trailer);                                                                                               
</span><span class="outsideLine"><i>0206</i>                                                                                                                                     
</span><span class="outsideLine"><i>0207</i>         // Next we need the root dictionary.                                                                                        
</span><span class="methodLine"><i>0208</i>         COSDictionary rootDictionary = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7245</span>new COSDictionary()</span>;                                                                         
</span><span class="methodLine"><i>0209</i>         trailer.setItem(COSName.ROOT, rootDictionary);                                                                              
</span><span class="methodLine"><i>0210</i>         rootDictionary.setItem(COSName.TYPE, COSName.CATALOG);                                                                      
</span><span class="methodLine"><i>0211</i>         rootDictionary.setItem(COSName.VERSION, COSName.getPDFName("1.4"));                                                         
</span><span class="outsideLine"><i>0212</i>                                                                                                                                     
</span><span class="outsideLine"><i>0213</i>         // next we need the pages tree structure                                                                                    
</span><span class="methodLine"><i>0214</i>         COSDictionary pages = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7259</span>new COSDictionary()</span>;                                                                                  
</span><span class="methodLine"><i>0215</i>         rootDictionary.setItem(COSName.PAGES, pages);                                                                               
</span><span class="methodLine"><i>0216</i>         pages.setItem(COSName.TYPE, COSName.PAGES);                                                                                 
</span><span class="methodLine"><i>0217</i>         COSArray kidsArray = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7267</span>new COSArray()</span>;                                                                                        
</span><span class="methodLine"><i>0218</i>         pages.setItem(COSName.KIDS, kidsArray);                                                                                     
</span><span class="methodLine"><i>0219</i>         pages.setItem(COSName.COUNT, COSInteger.ZERO);                                                                              
</span><span class="methodLine"><i>0220</i>     }                                                                                                                               
</span><span class="outsideLine"><i>0221</i>                                                                                                                                     
</span><span class="outsideLine"><i>0222</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0223</i>      * Constructor that uses an existing document. The COSDocument that is passed in must be valid.                                 
</span><span class="outsideLine"><i>0224</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0225</i>      * @param doc The COSDocument that this document wraps.                                                                         
</span><span class="outsideLine"><i>0226</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0227</i>     public PDDocument(COSDocument doc)                                                                                              
</span><span class="methodLine"><i>0228</i>     {                                                                                                                               
</span><span class="methodLine"><i>0229</i>         this(doc, null);                                                                                                            
</span><span class="methodLine"><i>0230</i>     }                                                                                                                               
</span><span class="outsideLine"><i>0231</i>                                                                                                                                     
</span><span class="outsideLine"><i>0232</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0233</i>      * Constructor that uses an existing document. The COSDocument that is passed in must be valid.                                 
</span><span class="outsideLine"><i>0234</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0235</i>      * @param doc The COSDocument that this document wraps.                                                                         
</span><span class="outsideLine"><i>0236</i>      * @param source the parser which is used to read the pdf                                                                       
</span><span class="outsideLine"><i>0237</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0238</i>     public PDDocument(COSDocument doc, RandomAccessRead source)                                                                     
</span><span class="methodLine"><i>0239</i>     {                                                                                                                               
</span><span class="methodLine"><i>0240</i>         this(doc, source, null);                                                                                                    
</span><span class="methodLine"><i>0241</i>     }                                                                                                                               
</span><span class="outsideLine"><i>0242</i>                                                                                                                                     
</span><span class="outsideLine"><i>0243</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0244</i>      * Constructor that uses an existing document. The COSDocument that is passed in must be valid.                                 
</span><span class="outsideLine"><i>0245</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0246</i>      * @param doc The COSDocument that this document wraps.                                                                         
</span><span class="outsideLine"><i>0247</i>      * @param source the parser which is used to read the pdf                                                                       
</span><span class="outsideLine"><i>0248</i>      * @param permission he access permissions of the pdf                                                                           
</span><span class="outsideLine"><i>0249</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0250</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0251</i>     public PDDocument(COSDocument doc, RandomAccessRead source, AccessPermission permission)                                        
</span><span class="methodLine"><i>0252</i>     {                                                                                                                               
</span><span class="methodLine"><i>0253</i>         document = doc;                                                                                                             
</span><span class="methodLine"><i>0254</i>         pdfSource = source;                                                                                                         
</span><span class="methodLine"><i>0255</i>         accessPermission = permission;                                                                                              
</span><span class="methodLine"><i>0256</i>     }                                                                                                                               
</span><span class="outsideLine"><i>0257</i>                                                                                                                                     
</span><span class="outsideLine"><i>0258</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0259</i>      * This will add a page to the document. This is a convenience method, that will add the page to the root of the                
</span><span class="outsideLine"><i>0260</i>      * hierarchy and set the parent of the page to the root.                                                                        
</span><span class="outsideLine"><i>0261</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0262</i>      * @param page The page to add to the document.                                                                                 
</span><span class="outsideLine"><i>0263</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0264</i>     public void addPage(PDPage page)                                                                                                
</span><span class="methodLine"><i>0265</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1410</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0266</i>         getPages().add(page);                                                                                                       
</span><span class="methodLine"><i>0267</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0268</i>                                                                                                                                     
</span><span class="outsideLine"><i>0269</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0270</i>      * Add parameters of signature to be created externally using default signature options. See                                    
</span><span class="outsideLine"><i>0271</i>      * {@link #saveIncrementalForExternalSigning(OutputStream)} method description on external                                      
</span><span class="outsideLine"><i>0272</i>      * signature creation scenario details.                                                                                         
</span><span class="outsideLine"><i>0273</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0274</i>      * Only one signature may be added in a document. To sign several times,                                                        
</span><span class="outsideLine"><i>0275</i>      * load document, add signature, save incremental and close again.                                                              
</span><span class="outsideLine"><i>0276</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0277</i>      * @param sigObject is the PDSignatureField model                                                                               
</span><span class="outsideLine"><i>0278</i>      * @throws IOException if there is an error creating required fields                                                            
</span><span class="outsideLine"><i>0279</i>      * @throws IllegalStateException if one attempts to add several signature                                                       
</span><span class="outsideLine"><i>0280</i>      * fields.                                                                                                                      
</span><span class="outsideLine"><i>0281</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0282</i>     public void addSignature(PDSignature sigObject) throws IOException                                                              
</span><span class="methodLine"><i>0283</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1417</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0284</i>         addSignature(sigObject, <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6509</span>new SignatureOptions()</span>);                                                                            
</span><span class="methodLine"><i>0285</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0286</i>                                                                                                                                     
</span><span class="outsideLine"><i>0287</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0288</i>      * Add parameters of signature to be created externally. See                                                                    
</span><span class="outsideLine"><i>0289</i>      * {@link #saveIncrementalForExternalSigning(OutputStream)} method description on external                                      
</span><span class="outsideLine"><i>0290</i>      * signature creation scenario details.                                                                                         
</span><span class="outsideLine"><i>0291</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0292</i>      * Only one signature may be added in a document. To sign several times,                                                        
</span><span class="outsideLine"><i>0293</i>      * load document, add signature, save incremental and close again.                                                              
</span><span class="outsideLine"><i>0294</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0295</i>      * @param sigObject is the PDSignatureField model                                                                               
</span><span class="outsideLine"><i>0296</i>      * @param options signature options                                                                                             
</span><span class="outsideLine"><i>0297</i>      * @throws IOException if there is an error creating required fields                                                            
</span><span class="outsideLine"><i>0298</i>      * @throws IllegalStateException if one attempts to add several signature                                                       
</span><span class="outsideLine"><i>0299</i>      * fields.                                                                                                                      
</span><span class="outsideLine"><i>0300</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0301</i>     public void addSignature(PDSignature sigObject, SignatureOptions options) throws IOException                                    
</span><span class="methodLine"><i>0302</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1424</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0303</i>         addSignature(sigObject, null, options);                                                                                     
</span><span class="methodLine"><i>0304</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0305</i>                                                                                                                                     
</span><span class="outsideLine"><i>0306</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0307</i>      * Add a signature to be created using the instance of given interface.                                                         
</span><span class="outsideLine"><i>0308</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0309</i>      * Only one signature may be added in a document. To sign several times,                                                        
</span><span class="outsideLine"><i>0310</i>      * load document, add signature, save incremental and close again.                                                              
</span><span class="outsideLine"><i>0311</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0312</i>      * @param sigObject is the PDSignatureField model                                                                               
</span><span class="outsideLine"><i>0313</i>      * @param signatureInterface is an interface whose implementation provides                                                      
</span><span class="outsideLine"><i>0314</i>      * signing capabilities. Can be null if external signing if used.                                                               
</span><span class="outsideLine"><i>0315</i>      * @throws IOException if there is an error creating required fields                                                            
</span><span class="outsideLine"><i>0316</i>      * @throws IllegalStateException if one attempts to add several signature                                                       
</span><span class="outsideLine"><i>0317</i>      * fields.                                                                                                                      
</span><span class="outsideLine"><i>0318</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0319</i>     public void addSignature(PDSignature sigObject, SignatureInterface signatureInterface) throws IOException                       
</span><span class="methodLine"><i>0320</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1431</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0321</i>         addSignature(sigObject, signatureInterface, <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6518</span>new SignatureOptions()</span>);                                                        
</span><span class="methodLine"><i>0322</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0323</i>                                                                                                                                     
</span><span class="outsideLine"><i>0324</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0325</i>      * This will add a signature to the document. If the 0-based page number in the options                                         
</span><span class="outsideLine"><i>0326</i>      * parameter is smaller than 0 or larger than max, the nearest valid page number will be used                                   
</span><span class="outsideLine"><i>0327</i>      * (i.e. 0 or max) and no exception will be thrown.                                                                             
</span><span class="outsideLine"><i>0328</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0329</i>      * Only one signature may be added in a document. To sign several times,                                                        
</span><span class="outsideLine"><i>0330</i>      * load document, add signature, save incremental and close again.                                                              
</span><span class="outsideLine"><i>0331</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0332</i>      * @param sigObject is the PDSignatureField model                                                                               
</span><span class="outsideLine"><i>0333</i>      * @param signatureInterface is an interface whose implementation provides                                                      
</span><span class="outsideLine"><i>0334</i>      * signing capabilities. Can be null if external signing if used.                                                               
</span><span class="outsideLine"><i>0335</i>      * @param options signature options                                                                                             
</span><span class="outsideLine"><i>0336</i>      * @throws IOException if there is an error creating required fields                                                            
</span><span class="outsideLine"><i>0337</i>      * @throws IllegalStateException if one attempts to add several signature                                                       
</span><span class="outsideLine"><i>0338</i>      * fields.                                                                                                                      
</span><span class="outsideLine"><i>0339</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0340</i>     public void addSignature(PDSignature sigObject, SignatureInterface signatureInterface,                                          
</span><span class="outsideLine"><i>0341</i>                              SignatureOptions options) throws IOException                                                           
</span><span class="methodLine"><i>0342</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1438</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0343</i>         if (signatureAdded)                                                                                                         
</span><span class="methodLine"><i>0344</i>         {                                                                                                                           
</span><span class="methodLine"><i>0345</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7292</span>new IllegalStateException("Only one signature may be added in a document")</span>;                                       
</span><span class="methodLine"><i>0346</i>         }                                                                                                                           
</span><span class="methodLine"><i>0347</i>         signatureAdded = true;                                                                                                      
</span><span class="outsideLine"><i>0348</i>                                                                                                                                     
</span><span class="outsideLine"><i>0349</i>         // Reserve content                                                                                                          
</span><span class="outsideLine"><i>0350</i>         // We need to reserve some space for the signature. Some signatures including                                               
</span><span class="outsideLine"><i>0351</i>         // big certificate chain and we need enough space to store it.                                                              
</span><span class="methodLine"><i>0352</i>         int preferredSignatureSize = options.getPreferredSignatureSize();                                                           
</span><span class="methodLine"><i>0353</i>         if (preferredSignatureSize <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4137</span>></span> 0)                                                                                             
</span><span class="methodLine"><i>0354</i>         {                                                                                                                           
</span><span class="methodLine"><i>0355</i>             sigObject.setContents(new byte[preferredSignatureSize]);                                                                
</span><span class="methodLine"><i>0356</i>         }                                                                                                                           
</span><span class="methodLine"><i>0357</i>         else                                                                                                                        
</span><span class="methodLine"><i>0358</i>         {                                                                                                                           
</span><span class="methodLine"><i>0359</i>             sigObject.setContents(new byte[SignatureOptions.DEFAULT_SIGNATURE_SIZE]);                                               
</span><span class="methodLine"><i>0360</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0361</i>                                                                                                                                     
</span><span class="outsideLine"><i>0362</i>         // Reserve ByteRange, will be overwritten in COSWriter                                                                      
</span><span class="methodLine"><i>0363</i>         sigObject.setByteRange(RESERVE_BYTE_RANGE);                                                                                 
</span><span class="outsideLine"><i>0364</i>                                                                                                                                     
</span><span class="methodLine"><i>0365</i>         signInterface = signatureInterface;                                                                                         
</span><span class="outsideLine"><i>0366</i>                                                                                                                                     
</span><span class="outsideLine"><i>0367</i>         // Create SignatureForm for signature and append it to the document                                                         
</span><span class="outsideLine"><i>0368</i>                                                                                                                                     
</span><span class="outsideLine"><i>0369</i>         // Get the first valid page                                                                                                 
</span><span class="methodLine"><i>0370</i>         int pageCount = getNumberOfPages();                                                                                         
</span><span class="methodLine"><i>0371</i>         if (pageCount <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4146</span>==</span> 0)                                                                                                         
</span><span class="methodLine"><i>0372</i>         {                                                                                                                           
</span><span class="methodLine"><i>0373</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7307</span>new IllegalStateException("Cannot sign an empty document")</span>;                                                       
</span><span class="methodLine"><i>0374</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0375</i>                                                                                                                                     
</span><span class="methodLine"><i>0376</i>         int startIndex = Math.min(Math.max(options.getPage(), 0), pageCount <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 7939</span>-</span> 1);                                                   
</span><span class="methodLine"><i>0377</i>         PDPage page = getPage(startIndex);                                                                                          
</span><span class="outsideLine"><i>0378</i>                                                                                                                                     
</span><span class="outsideLine"><i>0379</i>         // Get the AcroForm from the Root-Dictionary and append the annotation                                                      
</span><span class="methodLine"><i>0380</i>         PDDocumentCatalog catalog = getDocumentCatalog();                                                                           
</span><span class="methodLine"><i>0381</i>         PDAcroForm acroForm = catalog.getAcroForm(null);                                                                            
</span><span class="methodLine"><i>0382</i>         catalog.getCOSObject().setNeedToBeUpdated(true);                                                                            
</span><span class="outsideLine"><i>0383</i>                                                                                                                                     
</span><span class="methodLine"><i>0384</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4159</span>acroForm <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4159</span>==</span> null</span>)                                                                                                       
</span><span class="methodLine"><i>0385</i>         {                                                                                                                           
</span><span class="methodLine"><i>0386</i>             acroForm = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8611</span>new PDAcroForm(this)</span>;                                                                                        
</span><span class="methodLine"><i>0387</i>             catalog.setAcroForm(acroForm);                                                                                          
</span><span class="methodLine"><i>0388</i>         }                                                                                                                           
</span><span class="methodLine"><i>0389</i>         else                                                                                                                        
</span><span class="methodLine"><i>0390</i>         {                                                                                                                           
</span><span class="methodLine"><i>0391</i>             acroForm.getCOSObject().setNeedToBeUpdated(true);                                                                       
</span><span class="methodLine"><i>0392</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0393</i>                                                                                                                                     
</span><span class="methodLine"><i>0394</i>         PDSignatureField signatureField = null;                                                                                     
</span><span class="methodLine"><i>0395</i>         COSBase cosFieldBase = acroForm.getCOSObject().getDictionaryObject(COSName.FIELDS);                                         
</span><span class="methodLine"><i>0396</i>         if (cosFieldBase instanceof COSArray)                                                                                       
</span><span class="methodLine"><i>0397</i>         {                                                                                                                           
</span><span class="methodLine"><i>0398</i>             COSArray fieldArray = (COSArray) cosFieldBase;                                                                          
</span><span class="methodLine"><i>0399</i>             fieldArray.setNeedToBeUpdated(true);                                                                                    
</span><span class="methodLine"><i>0400</i>             signatureField = findSignatureField(acroForm.getFieldIterator(), sigObject);                                            
</span><span class="methodLine"><i>0401</i>         }                                                                                                                           
</span><span class="methodLine"><i>0402</i>         else                                                                                                                        
</span><span class="methodLine"><i>0403</i>         {                                                                                                                           
</span><span class="methodLine"><i>0404</i>             acroForm.getCOSObject().setItem(COSName.FIELDS, <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9193</span>new COSArray()</span>);                                                        
</span><span class="methodLine"><i>0405</i>         }                                                                                                                           
</span><span class="methodLine"><i>0406</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4173</span>signatureField <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4173</span>==</span> null</span>)                                                                                                 
</span><span class="methodLine"><i>0407</i>         {                                                                                                                           
</span><span class="methodLine"><i>0408</i>             signatureField = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8648</span>new PDSignatureField(acroForm)</span>;                                                                        
</span><span class="outsideLine"><i>0409</i>             // append the signature object                                                                                          
</span><span class="methodLine"><i>0410</i>             signatureField.setValue(sigObject);                                                                                     
</span><span class="outsideLine"><i>0411</i>             // backward linking                                                                                                     
</span><span class="methodLine"><i>0412</i>             signatureField.getWidgets().get(0).setPage(page);                                                                       
</span><span class="methodLine"><i>0413</i>         }                                                                                                                           
</span><span class="methodLine"><i>0414</i>         else                                                                                                                        
</span><span class="methodLine"><i>0415</i>         {                                                                                                                           
</span><span class="methodLine"><i>0416</i>             sigObject.getCOSObject().setNeedToBeUpdated(true);                                                                      
</span><span class="methodLine"><i>0417</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0418</i>                                                                                                                                     
</span><span class="outsideLine"><i>0419</i>         // TODO This "overwrites" the settings of the original signature field which might not be intended by the user              
</span><span class="outsideLine"><i>0420</i>         // better make it configurable (not all users need/want PDF/A but their own setting):                                       
</span><span class="outsideLine"><i>0421</i>                                                                                                                                     
</span><span class="outsideLine"><i>0422</i>         // to conform PDF/A-1 requirement:                                                                                          
</span><span class="outsideLine"><i>0423</i>         // The /F key's Print flag bit shall be set to 1 and                                                                        
</span><span class="outsideLine"><i>0424</i>         // its Hidden, Invisible and NoView flag bits shall be set to 0                                                             
</span><span class="methodLine"><i>0425</i>         signatureField.getWidgets().get(0).setPrinted(true);                                                                        
</span><span class="outsideLine"><i>0426</i>         // This may be troublesome if several form fields are signed,                                                               
</span><span class="outsideLine"><i>0427</i>         // see thread from PDFBox users mailing list 17.2.2021 - 19.2.2021                                                          
</span><span class="outsideLine"><i>0428</i>         // https://mail-archives.apache.org/mod_mbox/pdfbox-users/202102.mbox/thread                                                
</span><span class="outsideLine"><i>0429</i>         // better set the printed flag in advance                                                                                   
</span><span class="outsideLine"><i>0430</i>                                                                                                                                     
</span><span class="outsideLine"><i>0431</i>         // Set the AcroForm Fields                                                                                                  
</span><span class="methodLine"><i>0432</i>         List<PDField> acroFormFields = acroForm.getFields();                                                                        
</span><span class="methodLine"><i>0433</i>         acroForm.getCOSObject().setDirect(true);                                                                                    
</span><span class="methodLine"><i>0434</i>         acroForm.setSignaturesExist(true);                                                                                          
</span><span class="methodLine"><i>0435</i>         acroForm.setAppendOnly(true);                                                                                               
</span><span class="outsideLine"><i>0436</i>                                                                                                                                     
</span><span class="methodLine"><i>0437</i>         boolean checkFields = checkSignatureField(acroForm.getFieldIterator(), signatureField);                                     
</span><span class="methodLine"><i>0438</i>         if (checkFields)                                                                                                            
</span><span class="methodLine"><i>0439</i>         {                                                                                                                           
</span><span class="methodLine"><i>0440</i>             signatureField.getCOSObject().setNeedToBeUpdated(true);                                                                 
</span><span class="methodLine"><i>0441</i>         }                                                                                                                           
</span><span class="methodLine"><i>0442</i>         else                                                                                                                        
</span><span class="methodLine"><i>0443</i>         {                                                                                                                           
</span><span class="methodLine"><i>0444</i>             acroFormFields.add(signatureField);                                                                                     
</span><span class="methodLine"><i>0445</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0446</i>                                                                                                                                     
</span><span class="outsideLine"><i>0447</i>         // Get the object from the visual signature                                                                                 
</span><span class="methodLine"><i>0448</i>         COSDocument visualSignature = options.getVisualSignature();                                                                 
</span><span class="outsideLine"><i>0449</i>                                                                                                                                     
</span><span class="outsideLine"><i>0450</i>         // Distinction of case for visual and non-visual signature                                                                  
</span><span class="methodLine"><i>0451</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4193</span>visualSignature <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4193</span>==</span> null</span>)                                                                                                
</span><span class="methodLine"><i>0452</i>         {                                                                                                                           
</span><span class="methodLine"><i>0453</i>             prepareNonVisibleSignature(signatureField);                                                                             
</span><span class="methodLine"><i>0454</i>             return;                                                                                                                 
</span><span class="methodLine"><i>0455</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0456</i>                                                                                                                                     
</span><span class="methodLine"><i>0457</i>         prepareVisibleSignature(signatureField, acroForm, visualSignature);                                                         
</span><span class="outsideLine"><i>0458</i>                                                                                                                                     
</span><span class="outsideLine"><i>0459</i>         // Create Annotation / Field for signature                                                                                  
</span><span class="methodLine"><i>0460</i>         List<PDAnnotation> annotations = page.getAnnotations();                                                                     
</span><span class="outsideLine"><i>0461</i>                                                                                                                                     
</span><span class="outsideLine"><i>0462</i>         // Make /Annots a direct object to avoid problem if it is an existing indirect object:                                      
</span><span class="outsideLine"><i>0463</i>         // it would not be updated in incremental save, and if we'd set the /Annots array "to be updated"                           
</span><span class="outsideLine"><i>0464</i>         // while keeping it indirect, Adobe Reader would claim that the document had been modified.                                 
</span><span class="methodLine"><i>0465</i>         page.setAnnotations(annotations);                                                                                           
</span><span class="outsideLine"><i>0466</i>                                                                                                                                     
</span><span class="outsideLine"><i>0467</i>         // Get the annotations of the page and append the signature-annotation to it                                                
</span><span class="outsideLine"><i>0468</i>         // take care that page and acroforms do not share the same array (if so, we don't need to add it twice)                     
</span><span class="methodLine"><i>0469</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4201</span>!</span>(annotations instanceof COSArrayList <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 8029</span>&&</span>                                                                                
</span><span class="methodLine"><i>0470</i>               acroFormFields instanceof COSArrayList <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 7383</span>&&</span>                                                                             
</span><span class="methodLine"><i>0471</i>               ((COSArrayList<?>) annotations).toList().equals(((COSArrayList<?>) acroFormFields).toList()) <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 6631</span>&&</span>                       
</span><span class="methodLine"><i>0472</i>               checkFields))                                                                                                         
</span><span class="methodLine"><i>0473</i>         {                                                                                                                           
</span><span class="methodLine"><i>0474</i>             PDAnnotationWidget widget = signatureField.getWidgets().get(0);                                                         
</span><span class="outsideLine"><i>0475</i>             // use check to prevent the annotation widget from appearing twice                                                      
</span><span class="methodLine"><i>0476</i>             if (checkSignatureAnnotation(annotations, widget))                                                                      
</span><span class="methodLine"><i>0477</i>             {                                                                                                                       
</span><span class="methodLine"><i>0478</i>                 widget.getCOSObject().setNeedToBeUpdated(true);                                                                     
</span><span class="methodLine"><i>0479</i>             }                                                                                                                       
</span><span class="methodLine"><i>0480</i>             else                                                                                                                    
</span><span class="methodLine"><i>0481</i>             {                                                                                                                       
</span><span class="methodLine"><i>0482</i>                 annotations.add(widget);                                                                                            
</span><span class="methodLine"><i>0483</i>             }                                                                                                                       
</span><span class="methodLine"><i>0484</i>         }                                                                                                                           
</span><span class="methodLine"><i>0485</i>         page.getCOSObject().setNeedToBeUpdated(true);                                                                               
</span><span class="methodLine"><i>0486</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0487</i>                                                                                                                                     
</span><span class="outsideLine"><i>0488</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0489</i>      * Search acroform fields for signature field with specific signature dictionary.                                               
</span><span class="outsideLine"><i>0490</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0491</i>      * @param fieldIterator iterator on all fields.                                                                                 
</span><span class="outsideLine"><i>0492</i>      * @param sigObject signature object (the /V part).                                                                             
</span><span class="outsideLine"><i>0493</i>      * @return a signature field if found, or null if none was found.                                                               
</span><span class="outsideLine"><i>0494</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0495</i>     private PDSignatureField findSignatureField(Iterator<PDField> fieldIterator, PDSignature sigObject)                             
</span><span class="methodLine"><i>0496</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1443</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0497</i>         PDSignatureField signatureField = null;                                                                                     
</span><span class="methodLine"><i>0498</i>         while (fieldIterator.hasNext())                                                                                             
</span><span class="methodLine"><i>0499</i>         {                                                                                                                           
</span><span class="methodLine"><i>0500</i>             PDField pdField = fieldIterator.next();                                                                                 
</span><span class="methodLine"><i>0501</i>             if (pdField instanceof PDSignatureField)                                                                                
</span><span class="methodLine"><i>0502</i>             {                                                                                                                       
</span><span class="methodLine"><i>0503</i>                 PDSignature signature = ((PDSignatureField) pdField).getSignature();                                                
</span><span class="methodLine"><i>0504</i>                 if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 10086</span>signature <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 10086</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 9724</span>&&</span> signature.getCOSObject().equals(sigObject.getCOSObject()))                                 
</span><span class="methodLine"><i>0505</i>                 {                                                                                                                   
</span><span class="methodLine"><i>0506</i>                     signatureField = (PDSignatureField) pdField;                                                                    
</span><span class="methodLine"><i>0507</i>                     break;                                                                                                          
</span><span class="methodLine"><i>0508</i>                 }                                                                                                                   
</span><span class="methodLine"><i>0509</i>             }                                                                                                                       
</span><span class="methodLine"><i>0510</i>         }                                                                                                                           
</span><span class="methodLine"><i>0511</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 2983</span>return signatureField;</span>                                                                                                      
</span><span class="methodLine"><i>0512</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0513</i>                                                                                                                                     
</span><span class="outsideLine"><i>0514</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0515</i>      * Check if the field already exists in the field list.                                                                         
</span><span class="outsideLine"><i>0516</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0517</i>      * @param fieldIterator iterator on all fields.                                                                                 
</span><span class="outsideLine"><i>0518</i>      * @param signatureField the signature field.                                                                                   
</span><span class="outsideLine"><i>0519</i>      * @return true if the field already existed in the field list, false if not.                                                   
</span><span class="outsideLine"><i>0520</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0521</i>     private boolean checkSignatureField(Iterator<PDField> fieldIterator, PDSignatureField signatureField)                           
</span><span class="methodLine"><i>0522</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return false;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1448</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0523</i>         while (fieldIterator.hasNext())                                                                                             
</span><span class="methodLine"><i>0524</i>         {                                                                                                                           
</span><span class="methodLine"><i>0525</i>             PDField field = fieldIterator.next();                                                                                   
</span><span class="methodLine"><i>0526</i>             if (field instanceof PDSignatureField                                                                                   
</span><span class="methodLine"><i>0527</i>                     <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 7411</span>&&</span> field.getCOSObject().equals(signatureField.getCOSObject()))                                                  
</span><span class="methodLine"><i>0528</i>             {                                                                                                                       
</span><span class="methodLine"><i>0529</i>                 return true;                                                                                                        
</span><span class="methodLine"><i>0530</i>             }                                                                                                                       
</span><span class="methodLine"><i>0531</i>         }                                                                                                                           
</span><span class="methodLine"><i>0532</i>         return false;                                                                                                               
</span><span class="methodLine"><i>0533</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0534</i>                                                                                                                                     
</span><span class="outsideLine"><i>0535</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0536</i>      * Check if the widget already exists in the annotation list                                                                    
</span><span class="outsideLine"><i>0537</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0538</i>      * @param annotations the list of PDAnnotation fields.                                                                          
</span><span class="outsideLine"><i>0539</i>      * @param widget the annotation widget.                                                                                         
</span><span class="outsideLine"><i>0540</i>      * @return true if the widget already existed in the annotation list, false if not.                                             
</span><span class="outsideLine"><i>0541</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0542</i>     private boolean checkSignatureAnnotation(List<PDAnnotation> annotations, PDAnnotationWidget widget)                             
</span><span class="methodLine"><i>0543</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return false;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1453</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0544</i>         for (PDAnnotation annotation : annotations)                                                                                 
</span><span class="methodLine"><i>0545</i>         {                                                                                                                           
</span><span class="methodLine"><i>0546</i>             if (annotation.getCOSObject().equals(widget.getCOSObject()))                                                            
</span><span class="methodLine"><i>0547</i>             {                                                                                                                       
</span><span class="methodLine"><i>0548</i>                 return true;                                                                                                        
</span><span class="methodLine"><i>0549</i>             }                                                                                                                       
</span><span class="methodLine"><i>0550</i>         }                                                                                                                           
</span><span class="methodLine"><i>0551</i>         return false;                                                                                                               
</span><span class="methodLine"><i>0552</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0553</i>                                                                                                                                     
</span><span class="outsideLine"><i>0554</i>     private void prepareVisibleSignature(PDSignatureField signatureField, PDAcroForm acroForm,                                      
</span><span class="outsideLine"><i>0555</i>             COSDocument visualSignature)                                                                                            
</span><span class="methodLine"><i>0556</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1458</span>{</span>                                                                                                                               
</span><span class="outsideLine"><i>0557</i>         // Obtain visual signature object                                                                                           
</span><span class="methodLine"><i>0558</i>         boolean annotNotFound = true;                                                                                               
</span><span class="methodLine"><i>0559</i>         boolean sigFieldNotFound = true;                                                                                            
</span><span class="methodLine"><i>0560</i>         for (COSObject cosObject : visualSignature.getObjects())                                                                    
</span><span class="methodLine"><i>0561</i>         {                                                                                                                           
</span><span class="methodLine"><i>0562</i>             if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 8078</span>!</span>annotNotFound <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 7423</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 8080</span>!</span>sigFieldNotFound)                                                                                
</span><span class="methodLine"><i>0563</i>             {                                                                                                                       
</span><span class="methodLine"><i>0564</i>                 break;                                                                                                              
</span><span class="methodLine"><i>0565</i>             }                                                                                                                       
</span><span class="outsideLine"><i>0566</i>                                                                                                                                     
</span><span class="methodLine"><i>0567</i>             COSBase base = cosObject.getObject();                                                                                   
</span><span class="methodLine"><i>0568</i>             if (base instanceof COSDictionary)                                                                                      
</span><span class="methodLine"><i>0569</i>             {                                                                                                                       
</span><span class="methodLine"><i>0570</i>                 COSDictionary cosBaseDict = (COSDictionary) base;                                                                   
</span><span class="outsideLine"><i>0571</i>                                                                                                                                     
</span><span class="outsideLine"><i>0572</i>                 // Search for signature annotation                                                                                  
</span><span class="methodLine"><i>0573</i>                 COSBase type = cosBaseDict.getDictionaryObject(COSName.TYPE);                                                       
</span><span class="methodLine"><i>0574</i>                 if (annotNotFound <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 9756</span>&&</span> COSName.ANNOT.equals(type))                                                                    
</span><span class="methodLine"><i>0575</i>                 {                                                                                                                   
</span><span class="methodLine"><i>0576</i>                     assignSignatureRectangle(signatureField, cosBaseDict);                                                          
</span><span class="methodLine"><i>0577</i>                     annotNotFound = false;                                                                                          
</span><span class="methodLine"><i>0578</i>                 }                                                                                                                   
</span><span class="outsideLine"><i>0579</i>                                                                                                                                     
</span><span class="outsideLine"><i>0580</i>                 // Search for signature field                                                                                       
</span><span class="methodLine"><i>0581</i>                 COSBase fieldType = cosBaseDict.getDictionaryObject(COSName.FT);                                                    
</span><span class="methodLine"><i>0582</i>                 COSBase apDict = cosBaseDict.getDictionaryObject(COSName.AP);                                                       
</span><span class="methodLine"><i>0583</i>                 if (sigFieldNotFound <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 10124</span>&&</span> COSName.SIG.equals(fieldType) <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 9764</span>&&</span> apDict instanceof COSDictionary)                           
</span><span class="methodLine"><i>0584</i>                 {                                                                                                                   
</span><span class="methodLine"><i>0585</i>                     assignAppearanceDictionary(signatureField, (COSDictionary) apDict);                                             
</span><span class="methodLine"><i>0586</i>                     assignAcroFormDefaultResource(acroForm, cosBaseDict);                                                           
</span><span class="methodLine"><i>0587</i>                     sigFieldNotFound = false;                                                                                       
</span><span class="methodLine"><i>0588</i>                 }                                                                                                                   
</span><span class="methodLine"><i>0589</i>             }                                                                                                                       
</span><span class="methodLine"><i>0590</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0591</i>                                                                                                                                     
</span><span class="methodLine"><i>0592</i>         if (annotNotFound <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4239</span>||</span> sigFieldNotFound)                                                                                      
</span><span class="methodLine"><i>0593</i>         {                                                                                                                           
</span><span class="methodLine"><i>0594</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7433</span>new IllegalArgumentException("Template is missing required objects")</span>;                                             
</span><span class="methodLine"><i>0595</i>         }                                                                                                                           
</span><span class="methodLine"><i>0596</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0597</i>                                                                                                                                     
</span><span class="outsideLine"><i>0598</i>     private void assignSignatureRectangle(PDSignatureField signatureField, COSDictionary annotDict)                                 
</span><span class="methodLine"><i>0599</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1463</span>{</span>                                                                                                                               
</span><span class="outsideLine"><i>0600</i>         // Read and set the rectangle for visual signature                                                                          
</span><span class="methodLine"><i>0601</i>         COSArray rectArray = (COSArray) annotDict.getDictionaryObject(COSName.RECT);                                                
</span><span class="methodLine"><i>0602</i>         PDRectangle existingRectangle = signatureField.getWidgets().get(0).getRectangle();                                          
</span><span class="outsideLine"><i>0603</i>                                                                                                                                     
</span><span class="outsideLine"><i>0604</i>         //in case of an existing field keep the original rect                                                                       
</span><span class="methodLine"><i>0605</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4974</span>existingRectangle <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4974</span>==</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: && 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4249</span>||</span> existingRectangle.getCOSArray().size() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4976</span>!=</span> 4)                                               
</span><span class="methodLine"><i>0606</i>         {                                                                                                                           
</span><span class="methodLine"><i>0607</i>             PDRectangle rect = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9776</span>new PDRectangle(rectArray)</span>;                                                                          
</span><span class="methodLine"><i>0608</i>             signatureField.getWidgets().get(0).setRectangle(rect);                                                                  
</span><span class="methodLine"><i>0609</i>         }                                                                                                                           
</span><span class="methodLine"><i>0610</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0611</i>                                                                                                                                     
</span><span class="outsideLine"><i>0612</i>     private void assignAppearanceDictionary(PDSignatureField signatureField, COSDictionary apDict)                                  
</span><span class="methodLine"><i>0613</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1468</span>{</span>                                                                                                                               
</span><span class="outsideLine"><i>0614</i>         // read and set Appearance Dictionary                                                                                       
</span><span class="methodLine"><i>0615</i>         PDAppearanceDictionary ap = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7451</span>new PDAppearanceDictionary(apDict)</span>;                                                             
</span><span class="methodLine"><i>0616</i>         apDict.setDirect(true);                                                                                                     
</span><span class="methodLine"><i>0617</i>         signatureField.getWidgets().get(0).setAppearance(ap);                                                                       
</span><span class="methodLine"><i>0618</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0619</i>                                                                                                                                     
</span><span class="outsideLine"><i>0620</i>     private void assignAcroFormDefaultResource(PDAcroForm acroForm, COSDictionary newDict)                                          
</span><span class="methodLine"><i>0621</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1473</span>{</span>                                                                                                                               
</span><span class="outsideLine"><i>0622</i>         // read and set/update AcroForm default resource dictionary /DR if available                                                
</span><span class="methodLine"><i>0623</i>         COSBase newBase = newDict.getDictionaryObject(COSName.DR);                                                                  
</span><span class="methodLine"><i>0624</i>         if (newBase instanceof COSDictionary)                                                                                       
</span><span class="methodLine"><i>0625</i>         {                                                                                                                           
</span><span class="methodLine"><i>0626</i>             COSDictionary newDR = (COSDictionary) newBase;                                                                          
</span><span class="methodLine"><i>0627</i>             PDResources defaultResources = acroForm.getDefaultResources();                                                          
</span><span class="methodLine"><i>0628</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7468</span>defaultResources <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7468</span>==</span> null</span>)                                                                                           
</span><span class="methodLine"><i>0629</i>             {                                                                                                                       
</span><span class="methodLine"><i>0630</i>                 acroForm.getCOSObject().setItem(COSName.DR, newDR);                                                                 
</span><span class="methodLine"><i>0631</i>                 newDR.setDirect(true);                                                                                              
</span><span class="methodLine"><i>0632</i>                 newDR.setNeedToBeUpdated(true);                                                                                     
</span><span class="methodLine"><i>0633</i>             }                                                                                                                       
</span><span class="methodLine"><i>0634</i>             else                                                                                                                    
</span><span class="methodLine"><i>0635</i>             {                                                                                                                       
</span><span class="methodLine"><i>0636</i>                 COSDictionary oldDR = defaultResources.getCOSObject();                                                              
</span><span class="methodLine"><i>0637</i>                 COSBase newXObjectBase = newDR.getItem(COSName.XOBJECT);                                                            
</span><span class="methodLine"><i>0638</i>                 COSBase oldXObjectBase = oldDR.getItem(COSName.XOBJECT);                                                            
</span><span class="methodLine"><i>0639</i>                 if (newXObjectBase instanceof COSDictionary <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 9803</span>&&</span>                                                                      
</span><span class="methodLine"><i>0640</i>                     oldXObjectBase instanceof COSDictionary)                                                                        
</span><span class="methodLine"><i>0641</i>                 {                                                                                                                   
</span><span class="methodLine"><i>0642</i>                     ((COSDictionary) oldXObjectBase).addAll((COSDictionary) newXObjectBase);                                        
</span><span class="methodLine"><i>0643</i>                     oldDR.setNeedToBeUpdated(true);                                                                                 
</span><span class="methodLine"><i>0644</i>                 }                                                                                                                   
</span><span class="methodLine"><i>0645</i>             }                                                                                                                       
</span><span class="methodLine"><i>0646</i>         }                                                                                                                           
</span><span class="methodLine"><i>0647</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0648</i>                                                                                                                                     
</span><span class="outsideLine"><i>0649</i>     private void prepareNonVisibleSignature(PDSignatureField signatureField)                                                        
</span><span class="methodLine"><i>0650</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1478</span>{</span>                                                                                                                               
</span><span class="outsideLine"><i>0651</i>         // "Signature fields that are not intended to be visible shall                                                              
</span><span class="outsideLine"><i>0652</i>         // have an annotation rectangle that has zero height and width."                                                            
</span><span class="outsideLine"><i>0653</i>         // Set rectangle for non-visual signature to rectangle array [ 0 0 0 0 ]                                                    
</span><span class="methodLine"><i>0654</i>         signatureField.getWidgets().get(0).setRectangle(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6728</span>new PDRectangle()</span>);                                                         
</span><span class="outsideLine"><i>0655</i>                                                                                                                                     
</span><span class="outsideLine"><i>0656</i>         // The visual appearance must also exist for an invisible signature but may be empty.                                       
</span><span class="methodLine"><i>0657</i>         PDAppearanceDictionary appearanceDictionary = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7479</span>new PDAppearanceDictionary()</span>;                                                 
</span><span class="methodLine"><i>0658</i>         PDAppearanceStream appearanceStream = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7481</span>new PDAppearanceStream(this)</span>;                                                         
</span><span class="methodLine"><i>0659</i>         appearanceStream.setBBox(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6735</span>new PDRectangle()</span>);                                                                                
</span><span class="methodLine"><i>0660</i>         appearanceDictionary.setNormalAppearance(appearanceStream);                                                                 
</span><span class="methodLine"><i>0661</i>         signatureField.getWidgets().get(0).setAppearance(appearanceDictionary);                                                     
</span><span class="methodLine"><i>0662</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0663</i>                                                                                                                                     
</span><span class="outsideLine"><i>0664</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0665</i>      * This will add a list of signature fields to the document.                                                                    
</span><span class="outsideLine"><i>0666</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0667</i>      * @param sigFields are the PDSignatureFields that should be added to the document                                              
</span><span class="outsideLine"><i>0668</i>      * @param signatureInterface is an interface whose implementation provides                                                      
</span><span class="outsideLine"><i>0669</i>      * signing capabilities. Can be null if external signing if used.                                                               
</span><span class="outsideLine"><i>0670</i>      * @param options signature options                                                                                             
</span><span class="outsideLine"><i>0671</i>      * @throws IOException if there is an error creating required fields                                                            
</span><span class="outsideLine"><i>0672</i>      * @deprecated The method is misleading, because only one signature may be                                                      
</span><span class="outsideLine"><i>0673</i>      * added in a document. The method will be removed in the future.                                                               
</span><span class="outsideLine"><i>0674</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0675</i>     @Deprecated                                                                                                                     
</span><span class="outsideLine"><i>0676</i>     public void addSignatureField(List<PDSignatureField> sigFields, SignatureInterface signatureInterface,                          
</span><span class="outsideLine"><i>0677</i>             SignatureOptions options) throws IOException                                                                            
</span><span class="methodLine"><i>0678</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1486</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0679</i>         PDDocumentCatalog catalog = getDocumentCatalog();                                                                           
</span><span class="methodLine"><i>0680</i>         catalog.getCOSObject().setNeedToBeUpdated(true);                                                                            
</span><span class="outsideLine"><i>0681</i>                                                                                                                                     
</span><span class="methodLine"><i>0682</i>         PDAcroForm acroForm = catalog.getAcroForm(null);                                                                            
</span><span class="methodLine"><i>0683</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4285</span>acroForm <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4285</span>==</span> null</span>)                                                                                                       
</span><span class="methodLine"><i>0684</i>         {                                                                                                                           
</span><span class="methodLine"><i>0685</i>             acroForm = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8821</span>new PDAcroForm(this)</span>;                                                                                        
</span><span class="methodLine"><i>0686</i>             catalog.setAcroForm(acroForm);                                                                                          
</span><span class="methodLine"><i>0687</i>         }                                                                                                                           
</span><span class="methodLine"><i>0688</i>         COSDictionary acroFormDict = acroForm.getCOSObject();                                                                       
</span><span class="methodLine"><i>0689</i>         acroFormDict.setDirect(true);                                                                                               
</span><span class="methodLine"><i>0690</i>         acroFormDict.setNeedToBeUpdated(true);                                                                                      
</span><span class="methodLine"><i>0691</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4293</span>!</span>acroForm.isSignaturesExist())                                                                                          
</span><span class="methodLine"><i>0692</i>         {                                                                                                                           
</span><span class="outsideLine"><i>0693</i>             // 1 if at least one signature field is available                                                                       
</span><span class="methodLine"><i>0694</i>             acroForm.setSignaturesExist(true);                                                                                      
</span><span class="methodLine"><i>0695</i>         }                                                                                                                           
</span><span class="outsideLine"><i>0696</i>                                                                                                                                     
</span><span class="methodLine"><i>0697</i>         List<PDField> acroformFields = acroForm.getFields();                                                                        
</span><span class="outsideLine"><i>0698</i>                                                                                                                                     
</span><span class="methodLine"><i>0699</i>         for (PDSignatureField sigField : sigFields)                                                                                 
</span><span class="methodLine"><i>0700</i>         {                                                                                                                           
</span><span class="methodLine"><i>0701</i>             sigField.getCOSObject().setNeedToBeUpdated(true);                                                                       
</span><span class="outsideLine"><i>0702</i>                                                                                                                                     
</span><span class="outsideLine"><i>0703</i>             // Check if the field already exists                                                                                    
</span><span class="methodLine"><i>0704</i>             boolean checkSignatureField = checkSignatureField(acroForm.getFieldIterator(), sigField);                               
</span><span class="methodLine"><i>0705</i>             if (checkSignatureField)                                                                                                
</span><span class="methodLine"><i>0706</i>             {                                                                                                                       
</span><span class="methodLine"><i>0707</i>                 sigField.getCOSObject().setNeedToBeUpdated(true);                                                                   
</span><span class="methodLine"><i>0708</i>             }                                                                                                                       
</span><span class="methodLine"><i>0709</i>             else                                                                                                                    
</span><span class="methodLine"><i>0710</i>             {                                                                                                                       
</span><span class="methodLine"><i>0711</i>                 acroformFields.add(sigField);                                                                                       
</span><span class="methodLine"><i>0712</i>             }                                                                                                                       
</span><span class="outsideLine"><i>0713</i>                                                                                                                                     
</span><span class="outsideLine"><i>0714</i>             // Check if we need to add a signature                                                                                  
</span><span class="methodLine"><i>0715</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7529</span>sigField.getSignature() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7529</span>!=</span> null</span>)                                                                                    
</span><span class="methodLine"><i>0716</i>             {                                                                                                                       
</span><span class="methodLine"><i>0717</i>                 sigField.getCOSObject().setNeedToBeUpdated(true);                                                                   
</span><span class="methodLine"><i>0718</i>                 if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 9830</span>options <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 9830</span>==</span> null</span>)                                                                                                
</span><span class="methodLine"><i>0719</i>                 {                                                                                                                   
</span><span class="outsideLine"><i>0720</i>                     // TODO ??                                                                                                      
</span><span class="methodLine"><i>0721</i>                 }                                                                                                                   
</span><span class="methodLine"><i>0722</i>                 addSignature(sigField.getSignature(), signatureInterface, options);                                                 
</span><span class="methodLine"><i>0723</i>             }                                                                                                                       
</span><span class="methodLine"><i>0724</i>         }                                                                                                                           
</span><span class="methodLine"><i>0725</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0726</i>                                                                                                                                     
</span><span class="outsideLine"><i>0727</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0728</i>      * Remove the page from the document.                                                                                           
</span><span class="outsideLine"><i>0729</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0730</i>      * @param page The page to remove from the document.                                                                            
</span><span class="outsideLine"><i>0731</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0732</i>     public void removePage(PDPage page)                                                                                             
</span><span class="methodLine"><i>0733</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1491</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0734</i>         getPages().remove(page);                                                                                                    
</span><span class="methodLine"><i>0735</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0736</i>                                                                                                                                     
</span><span class="outsideLine"><i>0737</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0738</i>      * Remove the page from the document.                                                                                           
</span><span class="outsideLine"><i>0739</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0740</i>      * @param pageNumber 0 based index to page number.                                                                              
</span><span class="outsideLine"><i>0741</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0742</i>     public void removePage(int pageNumber)                                                                                          
</span><span class="methodLine"><i>0743</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1496</span>{                                                                                                                               
</span><span class="methodLine"><i>0744</i>         getPages().remove(pageNumber);                                                                                              
</span><span class="methodLine"><i>0745</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0746</i>                                                                                                                                     
</span><span class="outsideLine"><i>0747</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0748</i>      * This will import and copy the contents from another location. Currently the content stream is                                
</span><span class="outsideLine"><i>0749</i>      * stored in a scratch file. The scratch file is associated with the document. If you are adding                                
</span><span class="outsideLine"><i>0750</i>      * a page to this document from another document and want to copy the contents to this                                          
</span><span class="outsideLine"><i>0751</i>      * document's scratch file then use this method otherwise just use the {@link #addPage addPage()}                               
</span><span class="outsideLine"><i>0752</i>      * method.                                                                                                                      
</span><span class="outsideLine"><i>0753</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0754</i>      * Unlike {@link #addPage addPage()}, this method creates a new PDPage object. If your page has                                 
</span><span class="outsideLine"><i>0755</i>      * annotations, and if these link to pages not in the target document, then the target document                                 
</span><span class="outsideLine"><i>0756</i>      * might become huge. What you need to do is to delete page references of such annotations. See                                 
</span><span class="outsideLine"><i>0757</i>      * <a href="http://stackoverflow.com/a/35477351/535646">here</a> for how to do this.                                            
</span><span class="outsideLine"><i>0758</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0759</i>      * Inherited (global) resources are ignored because these can contain resources not needed for                                  
</span><span class="outsideLine"><i>0760</i>      * this page which could bloat your document, see                                                                               
</span><span class="outsideLine"><i>0761</i>      * <a href="https://issues.apache.org/jira/browse/PDFBOX-28">PDFBOX-28</a> and related issues.                                  
</span><span class="outsideLine"><i>0762</i>      * If you need them, call <code>importedPage.setResources(page.getResources());</code>                                          
</span><span class="outsideLine"><i>0763</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0764</i>      * This method should only be used to import a page from a loaded document, not from a generated                                
</span><span class="outsideLine"><i>0765</i>      * document because these can contain unfinished parts, e.g. font subsetting information.                                       
</span><span class="outsideLine"><i>0766</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0767</i>      * @param page The page to import.                                                                                              
</span><span class="outsideLine"><i>0768</i>      * @return The page that was imported.                                                                                          
</span><span class="outsideLine"><i>0769</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0770</i>      * @throws IOException If there is an error copying the page.                                                                   
</span><span class="outsideLine"><i>0771</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0772</i>     public PDPage importPage(PDPage page) throws IOException                                                                        
</span><span class="methodLine"><i>0773</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1503</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0774</i>         PDPage importedPage = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7537</span>new PDPage(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10209</span>new COSDictionary(page.getCOSObject())</span>, resourceCache)</span>;                                    
</span><span class="methodLine"><i>0775</i>         PDStream dest = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7539</span>new PDStream(this, page.getContents(), COSName.FLATE_DECODE)</span>;                                               
</span><span class="methodLine"><i>0776</i>         importedPage.setContents(dest);                                                                                             
</span><span class="methodLine"><i>0777</i>         addPage(importedPage);                                                                                                      
</span><span class="methodLine"><i>0778</i>         importedPage.setCropBox(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6806</span>new PDRectangle(page.getCropBox().getCOSArray())</span>);                                                  
</span><span class="methodLine"><i>0779</i>         importedPage.setMediaBox(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6809</span>new PDRectangle(page.getMediaBox().getCOSArray())</span>);                                                
</span><span class="methodLine"><i>0780</i>         importedPage.setRotation(page.getRotation());                                                                               
</span><span class="methodLine"><i>0781</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5098</span>page.getResources() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5098</span>!=</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4315</span>&&</span> <span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 5100</span>!</span>page.getCOSObject().containsKey(COSName.RESOURCES))                                     
</span><span class="methodLine"><i>0782</i>         {                                                                                                                           
</span><span class="methodLine"><i>0783</i>             LOG.warn("inherited resources of source document are not imported to destination page");                                
</span><span class="methodLine"><i>0784</i>             LOG.warn("call importedPage.setResources(page.getResources()) to do this");                                             
</span><span class="methodLine"><i>0785</i>         }                                                                                                                           
</span><span class="methodLine"><i>0786</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3067</span>return importedPage;</span>                                                                                                        
</span><span class="methodLine"><i>0787</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0788</i>                                                                                                                                     
</span><span class="outsideLine"><i>0789</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0790</i>      * This will get the low level document.                                                                                        
</span><span class="outsideLine"><i>0791</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0792</i>      * @return The document that this layer sits on top of.                                                                         
</span><span class="outsideLine"><i>0793</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0794</i>     public COSDocument getDocument()                                                                                                
</span><span class="methodLine"><i>0795</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1508</span>{                                                                                                                               
</span><span class="methodLine"><i>0796</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3068</span>return document;</span>                                                                                                            
</span><span class="methodLine"><i>0797</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0798</i>                                                                                                                                     
</span><span class="outsideLine"><i>0799</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0800</i>      * This will get the document info dictionary. If it doesn't exist, an empty document info                                      
</span><span class="outsideLine"><i>0801</i>      * dictionary is created in the document trailer.                                                                               
</span><span class="outsideLine"><i>0802</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0803</i>      * In PDF 2.0 this is deprecated except for two entries, /CreationDate and /ModDate. For any other                              
</span><span class="outsideLine"><i>0804</i>      * document level metadata, a metadata stream should be used instead, see                                                       
</span><span class="outsideLine"><i>0805</i>      * {@link PDDocumentCatalog#getMetadata()}.                                                                                     
</span><span class="outsideLine"><i>0806</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0807</i>      * @return The documents /Info dictionary, never null.                                                                          
</span><span class="outsideLine"><i>0808</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0809</i>     public PDDocumentInformation getDocumentInformation()                                                                           
</span><span class="methodLine"><i>0810</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1513</span>{                                                                                                                               
</span><span class="methodLine"><i>0811</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4321</span>documentInformation <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4321</span>==</span> null</span>)                                                                                            
</span><span class="methodLine"><i>0812</i>         {                                                                                                                           
</span><span class="methodLine"><i>0813</i>             COSDictionary trailer = document.getTrailer();                                                                          
</span><span class="methodLine"><i>0814</i>             COSDictionary infoDic = trailer.getCOSDictionary(COSName.INFO);                                                         
</span><span class="methodLine"><i>0815</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7569</span>infoDic <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7569</span>==</span> null</span>)                                                                                                    
</span><span class="methodLine"><i>0816</i>             {                                                                                                                       
</span><span class="methodLine"><i>0817</i>                 infoDic = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10562</span>new COSDictionary()</span>;                                                                                      
</span><span class="methodLine"><i>0818</i>                 trailer.setItem(COSName.INFO, infoDic);                                                                             
</span><span class="methodLine"><i>0819</i>             }                                                                                                                       
</span><span class="methodLine"><i>0820</i>             documentInformation = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8889</span>new PDDocumentInformation(infoDic)</span>;                                                               
</span><span class="methodLine"><i>0821</i>         }                                                                                                                           
</span><span class="methodLine"><i>0822</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3070</span>return documentInformation;</span>                                                                                                 
</span><span class="methodLine"><i>0823</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0824</i>                                                                                                                                     
</span><span class="outsideLine"><i>0825</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0826</i>      * This will set the document information for this document.                                                                    
</span><span class="outsideLine"><i>0827</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>0828</i>      * In PDF 2.0 this is deprecated except for two entries, /CreationDate and /ModDate. For any other                              
</span><span class="outsideLine"><i>0829</i>      * document level metadata, a metadata stream should be used instead, see                                                       
</span><span class="outsideLine"><i>0830</i>      * {@link PDDocumentCatalog#setMetadata(org.apache.pdfbox.pdmodel.common.PDMetadata) PDDocumentCatalog#setMetadata(PDMetadata)}.
</span><span class="outsideLine"><i>0831</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0832</i>      * @param info The updated document information.                                                                                
</span><span class="outsideLine"><i>0833</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0834</i>     public void setDocumentInformation(PDDocumentInformation info)                                                                  
</span><span class="methodLine"><i>0835</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1518</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0836</i>         documentInformation = info;                                                                                                 
</span><span class="methodLine"><i>0837</i>         document.getTrailer().setItem(COSName.INFO, info.getCOSObject());                                                           
</span><span class="methodLine"><i>0838</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0839</i>                                                                                                                                     
</span><span class="outsideLine"><i>0840</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0841</i>      * This will get the document CATALOG. This is guaranteed to not return null.                                                   
</span><span class="outsideLine"><i>0842</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0843</i>      * @return The documents /Root dictionary                                                                                       
</span><span class="outsideLine"><i>0844</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0845</i>     public PDDocumentCatalog getDocumentCatalog()                                                                                   
</span><span class="methodLine"><i>0846</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1523</span>{                                                                                                                               
</span><span class="methodLine"><i>0847</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4329</span>documentCatalog <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4329</span>==</span> null</span>)                                                                                                
</span><span class="methodLine"><i>0848</i>         {                                                                                                                           
</span><span class="methodLine"><i>0849</i>             COSDictionary trailer = document.getTrailer();                                                                          
</span><span class="methodLine"><i>0850</i>             COSBase dictionary = trailer.getDictionaryObject(COSName.ROOT);                                                         
</span><span class="methodLine"><i>0851</i>             if (dictionary instanceof COSDictionary)                                                                                
</span><span class="methodLine"><i>0852</i>             {                                                                                                                       
</span><span class="methodLine"><i>0853</i>                 documentCatalog = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10577</span>new PDDocumentCatalog(this, (COSDictionary) dictionary)</span>;                                          
</span><span class="methodLine"><i>0854</i>             }                                                                                                                       
</span><span class="methodLine"><i>0855</i>             else                                                                                                                    
</span><span class="methodLine"><i>0856</i>             {                                                                                                                       
</span><span class="methodLine"><i>0857</i>                 documentCatalog = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10580</span>new PDDocumentCatalog(this)</span>;                                                                      
</span><span class="methodLine"><i>0858</i>             }                                                                                                                       
</span><span class="methodLine"><i>0859</i>         }                                                                                                                           
</span><span class="methodLine"><i>0860</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3076</span>return documentCatalog;</span>                                                                                                     
</span><span class="methodLine"><i>0861</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0862</i>                                                                                                                                     
</span><span class="outsideLine"><i>0863</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0864</i>      * This will tell if this document is encrypted or not.                                                                         
</span><span class="outsideLine"><i>0865</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0866</i>      * @return true If this document is encrypted.                                                                                  
</span><span class="outsideLine"><i>0867</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0868</i>     public boolean isEncrypted()                                                                                                    
</span><span class="methodLine"><i>0869</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return false;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1528</span>{                                                                                                                               
</span><span class="methodLine"><i>0870</i>         return document.isEncrypted();                                                                                              
</span><span class="methodLine"><i>0871</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0872</i>                                                                                                                                     
</span><span class="outsideLine"><i>0873</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0874</i>      * This will get the encryption dictionary for this document. This will still return the parameters if the document             
</span><span class="outsideLine"><i>0875</i>      * was decrypted. As the encryption architecture in PDF documents is pluggable this returns an abstract class,                  
</span><span class="outsideLine"><i>0876</i>      * but the only supported subclass at this time is a                                                                            
</span><span class="outsideLine"><i>0877</i>      * PDStandardEncryption object.                                                                                                 
</span><span class="outsideLine"><i>0878</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0879</i>      * @return The encryption dictionary(most likely a PDStandardEncryption object)                                                 
</span><span class="outsideLine"><i>0880</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0881</i>     public PDEncryption getEncryption()                                                                                             
</span><span class="methodLine"><i>0882</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1533</span>{                                                                                                                               
</span><span class="methodLine"><i>0883</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 5136</span>encryption <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 5136</span>==</span> null</span> <span class="ConditionalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: || 
Mutation Operator Type: ConditionalOperatorReplacement 
Node ID: 4337</span>&&</span> isEncrypted())                                                                                    
</span><span class="methodLine"><i>0884</i>         {                                                                                                                           
</span><span class="methodLine"><i>0885</i>             encryption = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8906</span>new PDEncryption(document.getEncryptionDictionary())</span>;                                                      
</span><span class="methodLine"><i>0886</i>         }                                                                                                                           
</span><span class="methodLine"><i>0887</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3079</span>return encryption;</span>                                                                                                          
</span><span class="methodLine"><i>0888</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0889</i>                                                                                                                                     
</span><span class="outsideLine"><i>0890</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0891</i>      * This will set the encryption dictionary for this document.                                                                   
</span><span class="outsideLine"><i>0892</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0893</i>      * @param encryption The encryption dictionary(most likely a PDStandardEncryption object)                                       
</span><span class="outsideLine"><i>0894</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0895</i>      * @throws IOException If there is an error determining which security handler to use.                                          
</span><span class="outsideLine"><i>0896</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0897</i>     public void setEncryptionDictionary(PDEncryption encryption) throws IOException                                                 
</span><span class="methodLine"><i>0898</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1540</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0899</i>         this.encryption = encryption;                                                                                               
</span><span class="methodLine"><i>0900</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0901</i>                                                                                                                                     
</span><span class="outsideLine"><i>0902</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0903</i>      * This will return the last signature from the field tree. Note that this may not be the                                       
</span><span class="outsideLine"><i>0904</i>      * last in time when empty signature fields are created first but signed after other fields.                                    
</span><span class="outsideLine"><i>0905</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0906</i>      * @return the last signature as <code>PDSignatureField</code>.                                                                 
</span><span class="outsideLine"><i>0907</i>      * @throws IOException if no document catalog can be found.                                                                     
</span><span class="outsideLine"><i>0908</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0909</i>     public PDSignature getLastSignatureDictionary() throws IOException                                                              
</span><span class="methodLine"><i>0910</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1547</span>{                                                                                                                               
</span><span class="methodLine"><i>0911</i>         List<PDSignature> signatureDictionaries = getSignatureDictionaries();                                                       
</span><span class="methodLine"><i>0912</i>         int size = signatureDictionaries.size();                                                                                    
</span><span class="methodLine"><i>0913</i>         if (size <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: <= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4348</span>></span> 0)                                                                                                               
</span><span class="methodLine"><i>0914</i>         {                                                                                                                           
</span><span class="methodLine"><i>0915</i>             <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 6054</span>return signatureDictionaries.get(size <span class="ArithmeticOperatorReplacementBinary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementBinary 
Node ID: 8282</span>-</span> 1);</span>                                                                             
</span><span class="methodLine"><i>0916</i>         }                                                                                                                           
</span><span class="methodLine"><i>0917</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3086</span>return null;</span>                                                                                                                
</span><span class="methodLine"><i>0918</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0919</i>                                                                                                                                     
</span><span class="outsideLine"><i>0920</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0921</i>      * Retrieve all signature fields from the document.                                                                             
</span><span class="outsideLine"><i>0922</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0923</i>      * @return a <code>List</code> of <code>PDSignatureField</code>s                                                                
</span><span class="outsideLine"><i>0924</i>      * @throws IOException if no document catalog can be found.                                                                     
</span><span class="outsideLine"><i>0925</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0926</i>     public List<PDSignatureField> getSignatureFields() throws IOException                                                           
</span><span class="methodLine"><i>0927</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1554</span>{                                                                                                                               
</span><span class="methodLine"><i>0928</i>         List<PDSignatureField> fields = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7609</span>new ArrayList<PDSignatureField>()</span>;                                                          
</span><span class="methodLine"><i>0929</i>         PDAcroForm acroForm = getDocumentCatalog().getAcroForm(null);                                                               
</span><span class="methodLine"><i>0930</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4358</span>acroForm <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4358</span>!=</span> null</span>)                                                                                                       
</span><span class="methodLine"><i>0931</i>         {                                                                                                                           
</span><span class="methodLine"><i>0932</i>             for (PDField field : acroForm.getFieldTree())                                                                           
</span><span class="methodLine"><i>0933</i>             {                                                                                                                       
</span><span class="methodLine"><i>0934</i>                 if (field instanceof PDSignatureField)                                                                              
</span><span class="methodLine"><i>0935</i>                 {                                                                                                                   
</span><span class="methodLine"><i>0936</i>                     fields.add((PDSignatureField)field);                                                                            
</span><span class="methodLine"><i>0937</i>                 }                                                                                                                   
</span><span class="methodLine"><i>0938</i>             }                                                                                                                       
</span><span class="methodLine"><i>0939</i>         }                                                                                                                           
</span><span class="methodLine"><i>0940</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3093</span>return fields;</span>                                                                                                              
</span><span class="methodLine"><i>0941</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0942</i>                                                                                                                                     
</span><span class="outsideLine"><i>0943</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0944</i>      * Retrieve all signature dictionaries from the document.                                                                       
</span><span class="outsideLine"><i>0945</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0946</i>      * @return a <code>List</code> of <code>PDSignatureField</code>s                                                                
</span><span class="outsideLine"><i>0947</i>      * @throws IOException if no document catalog can be found.                                                                     
</span><span class="outsideLine"><i>0948</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0949</i>     public List<PDSignature> getSignatureDictionaries() throws IOException                                                          
</span><span class="methodLine"><i>0950</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1561</span>{                                                                                                                               
</span><span class="methodLine"><i>0951</i>         List<PDSignature> signatures = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7619</span>new ArrayList<PDSignature>()</span>;                                                                
</span><span class="methodLine"><i>0952</i>         for (PDSignatureField field : getSignatureFields())                                                                         
</span><span class="methodLine"><i>0953</i>         {                                                                                                                           
</span><span class="methodLine"><i>0954</i>             COSBase value = field.getCOSObject().getDictionaryObject(COSName.V);                                                    
</span><span class="methodLine"><i>0955</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7624</span>value <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7624</span>!=</span> null</span>)                                                                                                      
</span><span class="methodLine"><i>0956</i>             {                                                                                                                       
</span><span class="methodLine"><i>0957</i>                 signatures.add(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 10853</span>new PDSignature((COSDictionary)value)</span>);                                                              
</span><span class="methodLine"><i>0958</i>             }                                                                                                                       
</span><span class="methodLine"><i>0959</i>         }                                                                                                                           
</span><span class="methodLine"><i>0960</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3099</span>return signatures;</span>                                                                                                          
</span><span class="methodLine"><i>0961</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0962</i>                                                                                                                                     
</span><span class="outsideLine"><i>0963</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0964</i>      * For internal PDFBox use when creating PDF documents: register a TrueTypeFont to make sure it                                 
</span><span class="outsideLine"><i>0965</i>      * is closed when the PDDocument is closed to avoid memory leaks. Users don't have to call this                                 
</span><span class="outsideLine"><i>0966</i>      * method, it is done by the appropriate PDFont classes.                                                                        
</span><span class="outsideLine"><i>0967</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0968</i>      * @param ttf                                                                                                                   
</span><span class="outsideLine"><i>0969</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0970</i>     public void registerTrueTypeFontForClosing(TrueTypeFont ttf)                                                                    
</span><span class="methodLine"><i>0971</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1566</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0972</i>         fontsToClose.add(ttf);                                                                                                      
</span><span class="methodLine"><i>0973</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0974</i>                                                                                                                                     
</span><span class="outsideLine"><i>0975</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0976</i>      * Returns the list of fonts which will be subset before the document is saved.                                                 
</span><span class="outsideLine"><i>0977</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0978</i>     Set<PDFont> getFontsToSubset()                                                                                                  
</span><span class="methodLine"><i>0979</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1570</span>{                                                                                                                               
</span><span class="methodLine"><i>0980</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3106</span>return fontsToSubset;</span>                                                                                                       
</span><span class="methodLine"><i>0981</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0982</i>                                                                                                                                     
</span><span class="outsideLine"><i>0983</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0984</i>      * Parses a PDF. Unrestricted main memory will be used for buffering PDF streams.                                               
</span><span class="outsideLine"><i>0985</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0986</i>      * @param file file to be loaded                                                                                                
</span><span class="outsideLine"><i>0987</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0988</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>0989</i>      *                                                                                                                              
</span><span class="outsideLine"><i>0990</i>      * @throws InvalidPasswordException If the file required a non-empty password.                                                  
</span><span class="outsideLine"><i>0991</i>      * @throws IOException in case of a file reading or parsing error                                                               
</span><span class="outsideLine"><i>0992</i>      */                                                                                                                             
</span><span class="outsideLine"><i>0993</i>     public static PDDocument load(File file) throws IOException                                                                     
</span><span class="methodLine"><i>0994</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1578</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>0995</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3109</span>return load(file, "", MemoryUsageSetting.setupMainMemoryOnly());</span>                                                            
</span><span class="methodLine"><i>0996</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>0997</i>                                                                                                                                     
</span><span class="outsideLine"><i>0998</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>0999</i>      * Parses a PDF.                                                                                                                
</span><span class="outsideLine"><i>1000</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1001</i>      * @param file file to be loaded                                                                                                
</span><span class="outsideLine"><i>1002</i>      * @param memUsageSetting defines how memory is used for buffering PDF streams                                                  
</span><span class="outsideLine"><i>1003</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1004</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1005</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1006</i>      * @throws InvalidPasswordException If the file required a non-empty password.                                                  
</span><span class="outsideLine"><i>1007</i>      * @throws IOException in case of a file reading or parsing error                                                               
</span><span class="outsideLine"><i>1008</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1009</i>     public static PDDocument load(File file, MemoryUsageSetting memUsageSetting)                                                    
</span><span class="outsideLine"><i>1010</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1011</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1586</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1012</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3114</span>return load(file, "", null, null, memUsageSetting);</span>                                                                         
</span><span class="methodLine"><i>1013</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1014</i>                                                                                                                                     
</span><span class="outsideLine"><i>1015</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1016</i>      * Parses a PDF. Unrestricted main memory will be used for buffering PDF streams.                                               
</span><span class="outsideLine"><i>1017</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1018</i>      * @param file file to be loaded                                                                                                
</span><span class="outsideLine"><i>1019</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1020</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1021</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1022</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1023</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1024</i>      * @throws IOException in case of a file reading or parsing error                                                               
</span><span class="outsideLine"><i>1025</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1026</i>     public static PDDocument load(File file, String password)                                                                       
</span><span class="outsideLine"><i>1027</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1028</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1594</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1029</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3119</span>return load(file, password, null, null, MemoryUsageSetting.setupMainMemoryOnly());</span>                                          
</span><span class="methodLine"><i>1030</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1031</i>                                                                                                                                     
</span><span class="outsideLine"><i>1032</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1033</i>      * Parses a PDF.                                                                                                                
</span><span class="outsideLine"><i>1034</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1035</i>      * @param file file to be loaded                                                                                                
</span><span class="outsideLine"><i>1036</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1037</i>      * @param memUsageSetting defines how memory is used for buffering PDF streams                                                  
</span><span class="outsideLine"><i>1038</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1039</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1040</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1041</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1042</i>      * @throws IOException in case of a file reading or parsing error                                                               
</span><span class="outsideLine"><i>1043</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1044</i>     public static PDDocument load(File file, String password, MemoryUsageSetting memUsageSetting)                                   
</span><span class="outsideLine"><i>1045</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1046</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1602</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1047</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3126</span>return load(file, password, null, null, memUsageSetting);</span>                                                                   
</span><span class="methodLine"><i>1048</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1049</i>                                                                                                                                     
</span><span class="outsideLine"><i>1050</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1051</i>      * Parses a PDF. Unrestricted main memory will be used for buffering PDF streams.                                               
</span><span class="outsideLine"><i>1052</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1053</i>      * @param file file to be loaded                                                                                                
</span><span class="outsideLine"><i>1054</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1055</i>      * @param keyStore key store to be used for decryption when using public key security                                           
</span><span class="outsideLine"><i>1056</i>      * @param alias alias to be used for decryption when using public key security                                                  
</span><span class="outsideLine"><i>1057</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1058</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1059</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1060</i>      * @throws IOException in case of a file reading or parsing error                                                               
</span><span class="outsideLine"><i>1061</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1062</i>     public static PDDocument load(File file, String password, InputStream keyStore, String alias)                                   
</span><span class="outsideLine"><i>1063</i>     throws IOException                                                                                                              
</span><span class="methodLine"><i>1064</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1610</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1065</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3135</span>return load(file, password, keyStore, alias, MemoryUsageSetting.setupMainMemoryOnly());</span>                                     
</span><span class="methodLine"><i>1066</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1067</i>                                                                                                                                     
</span><span class="outsideLine"><i>1068</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1069</i>      * Parses a PDF.                                                                                                                
</span><span class="outsideLine"><i>1070</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1071</i>      * @param file file to be loaded                                                                                                
</span><span class="outsideLine"><i>1072</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1073</i>      * @param keyStore key store to be used for decryption when using public key security                                           
</span><span class="outsideLine"><i>1074</i>      * @param alias alias to be used for decryption when using public key security                                                  
</span><span class="outsideLine"><i>1075</i>      * @param memUsageSetting defines how memory is used for buffering PDF streams                                                  
</span><span class="outsideLine"><i>1076</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1077</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1078</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1079</i>      * @throws IOException in case of a file reading or parsing error                                                               
</span><span class="outsideLine"><i>1080</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1081</i>     public static PDDocument load(File file, String password, InputStream keyStore, String alias,                                   
</span><span class="outsideLine"><i>1082</i>                                   MemoryUsageSetting memUsageSetting) throws IOException                                            
</span><span class="methodLine"><i>1083</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1618</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1084</i>         @SuppressWarnings({"squid:S2095"}) // raFile not closed here, may be needed for signing                                     
</span><span class="methodLine"><i>1085</i>         RandomAccessBufferedFileInputStream raFile = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7645</span>new RandomAccessBufferedFileInputStream(file)</span>;                                 
</span><span class="methodLine"><i>1086</i>         try                                                                                                                         
</span><span class="methodLine"><i>1087</i>         {                                                                                                                           
</span><span class="methodLine"><i>1088</i>             <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 5236</span>return load(raFile, password, keyStore, alias, memUsageSetting);</span>                                                        
</span><span class="methodLine"><i>1089</i>         }                                                                                                                           
</span><span class="methodLine"><i>1090</i>         catch (IOException ioe)                                                                                                     
</span><span class="methodLine"><i>1091</i>         {                                                                                                                           
</span><span class="methodLine"><i>1092</i>             IOUtils.closeQuietly(raFile);                                                                                           
</span><span class="methodLine"><i>1093</i>             throw ioe;                                                                                                              
</span><span class="methodLine"><i>1094</i>         }                                                                                                                           
</span><span class="methodLine"><i>1095</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1096</i>                                                                                                                                     
</span><span class="outsideLine"><i>1097</i>     private static PDDocument load(RandomAccessBufferedFileInputStream raFile, String password,                                     
</span><span class="outsideLine"><i>1098</i>                                    InputStream keyStore, String alias,                                                              
</span><span class="outsideLine"><i>1099</i>                                    MemoryUsageSetting memUsageSetting) throws IOException                                           
</span><span class="methodLine"><i>1100</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1626</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1101</i>         ScratchFile scratchFile = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7659</span>new ScratchFile(memUsageSetting)</span>;                                                                 
</span><span class="methodLine"><i>1102</i>         try                                                                                                                         
</span><span class="methodLine"><i>1103</i>         {                                                                                                                           
</span><span class="methodLine"><i>1104</i>             PDFParser parser = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9464</span>new PDFParser(raFile, password, keyStore, alias, scratchFile)</span>;                                       
</span><span class="methodLine"><i>1105</i>             parser.parse();                                                                                                         
</span><span class="methodLine"><i>1106</i>             <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 5246</span>return parser.getPDDocument();</span>                                                                                          
</span><span class="methodLine"><i>1107</i>         }                                                                                                                           
</span><span class="methodLine"><i>1108</i>         catch (IOException ioe)                                                                                                     
</span><span class="methodLine"><i>1109</i>         {                                                                                                                           
</span><span class="methodLine"><i>1110</i>             IOUtils.closeQuietly(scratchFile);                                                                                      
</span><span class="methodLine"><i>1111</i>             throw ioe;                                                                                                              
</span><span class="methodLine"><i>1112</i>         }                                                                                                                           
</span><span class="methodLine"><i>1113</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1114</i>                                                                                                                                     
</span><span class="outsideLine"><i>1115</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1116</i>      * Parses a PDF. The given input stream is copied to the memory to enable random access to the                                  
</span><span class="outsideLine"><i>1117</i>      * pdf. Unrestricted main memory will be used for buffering PDF streams.                                                        
</span><span class="outsideLine"><i>1118</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1119</i>      * @param input stream that contains the document. Don't forget to close it after loading.                                      
</span><span class="outsideLine"><i>1120</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1121</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1122</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1123</i>      * @throws InvalidPasswordException If the PDF required a non-empty password.                                                   
</span><span class="outsideLine"><i>1124</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1125</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1126</i>     public static PDDocument load(InputStream input) throws IOException                                                             
</span><span class="methodLine"><i>1127</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1634</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1128</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3162</span>return load(input, "", null, null, MemoryUsageSetting.setupMainMemoryOnly());</span>                                               
</span><span class="methodLine"><i>1129</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1130</i>                                                                                                                                     
</span><span class="outsideLine"><i>1131</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1132</i>      * Parses a PDF. Depending on the memory settings parameter the given input stream is either                                    
</span><span class="outsideLine"><i>1133</i>      * copied to main memory or to a temporary file to enable random access to the pdf.                                             
</span><span class="outsideLine"><i>1134</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1135</i>      * @param input stream that contains the document. Don't forget to close it after loading.                                      
</span><span class="outsideLine"><i>1136</i>      * @param memUsageSetting defines how memory is used for buffering input stream and PDF streams                                 
</span><span class="outsideLine"><i>1137</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1138</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1139</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1140</i>      * @throws InvalidPasswordException If the PDF required a non-empty password.                                                   
</span><span class="outsideLine"><i>1141</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1142</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1143</i>     public static PDDocument load(InputStream input, MemoryUsageSetting memUsageSetting)                                            
</span><span class="outsideLine"><i>1144</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1145</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1642</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1146</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3167</span>return load(input, "", null, null, memUsageSetting);</span>                                                                        
</span><span class="methodLine"><i>1147</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1148</i>                                                                                                                                     
</span><span class="outsideLine"><i>1149</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1150</i>      * Parses a PDF. The given input stream is copied to the memory to enable random access to the                                  
</span><span class="outsideLine"><i>1151</i>      * pdf. Unrestricted main memory will be used for buffering PDF streams.                                                        
</span><span class="outsideLine"><i>1152</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1153</i>      * @param input stream that contains the document. Don't forget to close it after loading.                                      
</span><span class="outsideLine"><i>1154</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1155</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1156</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1157</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1158</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1159</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1160</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1161</i>     public static PDDocument load(InputStream input, String password)                                                               
</span><span class="outsideLine"><i>1162</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1163</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1650</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1164</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3172</span>return load(input, password, null, null, MemoryUsageSetting.setupMainMemoryOnly());</span>                                         
</span><span class="methodLine"><i>1165</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1166</i>                                                                                                                                     
</span><span class="outsideLine"><i>1167</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1168</i>      * Parses a PDF. The given input stream is copied to the memory to enable random access to the                                  
</span><span class="outsideLine"><i>1169</i>      * pdf. Unrestricted main memory will be used for buffering PDF streams.                                                        
</span><span class="outsideLine"><i>1170</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1171</i>      * @param input stream that contains the document. Don't forget to close it after loading.                                      
</span><span class="outsideLine"><i>1172</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1173</i>      * @param keyStore key store to be used for decryption when using public key security                                           
</span><span class="outsideLine"><i>1174</i>      * @param alias alias to be used for decryption when using public key security                                                  
</span><span class="outsideLine"><i>1175</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1176</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1177</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1178</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1179</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1180</i>     public static PDDocument load(InputStream input, String password, InputStream keyStore, String alias)                           
</span><span class="outsideLine"><i>1181</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1182</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1658</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1183</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3181</span>return load(input, password, keyStore, alias, MemoryUsageSetting.setupMainMemoryOnly());</span>                                    
</span><span class="methodLine"><i>1184</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1185</i>                                                                                                                                     
</span><span class="outsideLine"><i>1186</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1187</i>      * Parses a PDF. Depending on the memory settings parameter the given input stream is either                                    
</span><span class="outsideLine"><i>1188</i>      * copied to main memory or to a temporary file to enable random access to the pdf.                                             
</span><span class="outsideLine"><i>1189</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1190</i>      * @param input stream that contains the document. Don't forget to close it after loading.                                      
</span><span class="outsideLine"><i>1191</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1192</i>      * @param memUsageSetting defines how memory is used for buffering input stream and PDF streams                                 
</span><span class="outsideLine"><i>1193</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1194</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1195</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1196</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1197</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1198</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1199</i>     public static PDDocument load(InputStream input, String password, MemoryUsageSetting memUsageSetting)                           
</span><span class="outsideLine"><i>1200</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1201</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1666</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1202</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3188</span>return load(input, password, null, null, memUsageSetting);</span>                                                                  
</span><span class="methodLine"><i>1203</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1204</i>                                                                                                                                     
</span><span class="outsideLine"><i>1205</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1206</i>      * Parses a PDF. Depending on the memory settings parameter the given input stream is either                                    
</span><span class="outsideLine"><i>1207</i>      * copied to memory or to a temporary file to enable random access to the pdf.                                                  
</span><span class="outsideLine"><i>1208</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1209</i>      * @param input stream that contains the document. Don't forget to close it after loading.                                      
</span><span class="outsideLine"><i>1210</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1211</i>      * @param keyStore key store to be used for decryption when using public key security                                           
</span><span class="outsideLine"><i>1212</i>      * @param alias alias to be used for decryption when using public key security                                                  
</span><span class="outsideLine"><i>1213</i>      * @param memUsageSetting defines how memory is used for buffering input stream and PDF streams                                 
</span><span class="outsideLine"><i>1214</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1215</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1216</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1217</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1218</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1219</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1220</i>     public static PDDocument load(InputStream input, String password, InputStream keyStore,                                         
</span><span class="outsideLine"><i>1221</i>                                   String alias, MemoryUsageSetting memUsageSetting) throws IOException                              
</span><span class="methodLine"><i>1222</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1674</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1223</i>         ScratchFile scratchFile = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7684</span>new ScratchFile(memUsageSetting)</span>;                                                                 
</span><span class="methodLine"><i>1224</i>         try                                                                                                                         
</span><span class="methodLine"><i>1225</i>         {                                                                                                                           
</span><span class="methodLine"><i>1226</i>             RandomAccessRead source = scratchFile.createBuffer(input);                                                              
</span><span class="methodLine"><i>1227</i>             PDFParser parser = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9476</span>new PDFParser(source, password, keyStore, alias, scratchFile)</span>;                                       
</span><span class="methodLine"><i>1228</i>             parser.parse();                                                                                                         
</span><span class="methodLine"><i>1229</i>             <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 5307</span>return parser.getPDDocument();</span>                                                                                          
</span><span class="methodLine"><i>1230</i>         }                                                                                                                           
</span><span class="methodLine"><i>1231</i>         catch (IOException ioe)                                                                                                     
</span><span class="methodLine"><i>1232</i>         {                                                                                                                           
</span><span class="methodLine"><i>1233</i>             IOUtils.closeQuietly(scratchFile);                                                                                      
</span><span class="methodLine"><i>1234</i>             throw ioe;                                                                                                              
</span><span class="methodLine"><i>1235</i>         }                                                                                                                           
</span><span class="methodLine"><i>1236</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1237</i>                                                                                                                                     
</span><span class="outsideLine"><i>1238</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1239</i>      * Parses a PDF. Unrestricted main memory will be used for buffering PDF streams.                                               
</span><span class="outsideLine"><i>1240</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1241</i>      * @param input byte array that contains the document.                                                                          
</span><span class="outsideLine"><i>1242</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1243</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1244</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1245</i>      * @throws InvalidPasswordException If the PDF required a non-empty password.                                                   
</span><span class="outsideLine"><i>1246</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1247</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1248</i>     public static PDDocument load(byte[] input) throws IOException                                                                  
</span><span class="methodLine"><i>1249</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1682</span>{                                                                                                                               
</span><span class="methodLine"><i>1250</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3203</span>return load(input, "");</span>                                                                                                     
</span><span class="methodLine"><i>1251</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1252</i>                                                                                                                                     
</span><span class="outsideLine"><i>1253</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1254</i>      * Parses a PDF. Unrestricted main memory will be used for buffering PDF streams.                                               
</span><span class="outsideLine"><i>1255</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1256</i>      * @param input byte array that contains the document.                                                                          
</span><span class="outsideLine"><i>1257</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1258</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1259</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1260</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1261</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1262</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1263</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1264</i>     public static PDDocument load(byte[] input, String password)                                                                    
</span><span class="outsideLine"><i>1265</i>             throws IOException                                                                                                      
</span><span class="methodLine"><i>1266</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1690</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1267</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3208</span>return load(input, password, null, null);</span>                                                                                   
</span><span class="methodLine"><i>1268</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1269</i>                                                                                                                                     
</span><span class="outsideLine"><i>1270</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1271</i>      * Parses a PDF. Unrestricted main memory will be used for buffering PDF streams.                                               
</span><span class="outsideLine"><i>1272</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1273</i>      * @param input byte array that contains the document.                                                                          
</span><span class="outsideLine"><i>1274</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1275</i>      * @param keyStore key store to be used for decryption when using public key security                                           
</span><span class="outsideLine"><i>1276</i>      * @param alias alias to be used for decryption when using public key security                                                  
</span><span class="outsideLine"><i>1277</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1278</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1279</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1280</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1281</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1282</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1283</i>     public static PDDocument load(byte[] input, String password, InputStream keyStore,                                              
</span><span class="outsideLine"><i>1284</i>             String alias) throws IOException                                                                                        
</span><span class="methodLine"><i>1285</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1698</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1286</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3217</span>return load(input, password, keyStore, alias, MemoryUsageSetting.setupMainMemoryOnly());</span>                                    
</span><span class="methodLine"><i>1287</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1288</i>                                                                                                                                     
</span><span class="outsideLine"><i>1289</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1290</i>      * Parses a PDF.                                                                                                                
</span><span class="outsideLine"><i>1291</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1292</i>      * @param input byte array that contains the document.                                                                          
</span><span class="outsideLine"><i>1293</i>      * @param password password to be used for decryption                                                                           
</span><span class="outsideLine"><i>1294</i>      * @param keyStore key store to be used for decryption when using public key security                                           
</span><span class="outsideLine"><i>1295</i>      * @param alias alias to be used for decryption when using public key security                                                  
</span><span class="outsideLine"><i>1296</i>      * @param memUsageSetting defines how memory is used for buffering input stream and PDF streams                                 
</span><span class="outsideLine"><i>1297</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1298</i>      * @return loaded document                                                                                                      
</span><span class="outsideLine"><i>1299</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1300</i>      * @throws InvalidPasswordException If the password is incorrect.                                                               
</span><span class="outsideLine"><i>1301</i>      * @throws IOException In case of a reading or parsing error.                                                                   
</span><span class="outsideLine"><i>1302</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1303</i>     public static PDDocument load(byte[] input, String password, InputStream keyStore,                                              
</span><span class="outsideLine"><i>1304</i>             String alias, MemoryUsageSetting memUsageSetting) throws IOException                                                    
</span><span class="methodLine"><i>1305</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1706</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1306</i>         ScratchFile scratchFile = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7702</span>new ScratchFile(memUsageSetting)</span>;                                                                 
</span><span class="methodLine"><i>1307</i>         RandomAccessRead source = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7704</span>new RandomAccessBuffer(input)</span>;                                                                    
</span><span class="methodLine"><i>1308</i>         PDFParser parser = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7706</span>new PDFParser(source, password, keyStore, alias, scratchFile)</span>;                                           
</span><span class="methodLine"><i>1309</i>         parser.parse();                                                                                                             
</span><span class="methodLine"><i>1310</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3232</span>return parser.getPDDocument();</span>                                                                                              
</span><span class="methodLine"><i>1311</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1312</i>                                                                                                                                     
</span><span class="outsideLine"><i>1313</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1314</i>      * Save the document to a file.                                                                                                 
</span><span class="outsideLine"><i>1315</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1316</i>      * If encryption has been activated (with                                                                                       
</span><span class="outsideLine"><i>1317</i>      * {@link #protect(org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy) protect(ProtectionPolicy)}),                          
</span><span class="outsideLine"><i>1318</i>      * do not use the document after saving because the contents are now encrypted.                                                 
</span><span class="outsideLine"><i>1319</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1320</i>      * @param fileName The file to save as.                                                                                         
</span><span class="outsideLine"><i>1321</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1322</i>      * @throws IOException if the output could not be written                                                                       
</span><span class="outsideLine"><i>1323</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1324</i>     public void save(String fileName) throws IOException                                                                            
</span><span class="methodLine"><i>1325</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1713</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1326</i>         save(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7031</span>new File(fileName)</span>);                                                                                                   
</span><span class="methodLine"><i>1327</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1328</i>                                                                                                                                     
</span><span class="outsideLine"><i>1329</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1330</i>      * Save the document to a file.                                                                                                 
</span><span class="outsideLine"><i>1331</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1332</i>      * If encryption has been activated (with                                                                                       
</span><span class="outsideLine"><i>1333</i>      * {@link #protect(org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy) protect(ProtectionPolicy)}),                          
</span><span class="outsideLine"><i>1334</i>      * do not use the document after saving because the contents are now encrypted.                                                 
</span><span class="outsideLine"><i>1335</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1336</i>      * @param file The file to save as.                                                                                             
</span><span class="outsideLine"><i>1337</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1338</i>      * @throws IOException if the output could not be written                                                                       
</span><span class="outsideLine"><i>1339</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1340</i>     public void save(File file) throws IOException                                                                                  
</span><span class="methodLine"><i>1341</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1720</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1342</i>         save(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7034</span>new BufferedOutputStream(<span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9928</span>new FileOutputStream(file)</span>)</span>);                                                                 
</span><span class="methodLine"><i>1343</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1344</i>                                                                                                                                     
</span><span class="outsideLine"><i>1345</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1346</i>      * This will save the document to an output stream.                                                                             
</span><span class="outsideLine"><i>1347</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1348</i>      * If encryption has been activated (with                                                                                       
</span><span class="outsideLine"><i>1349</i>      * {@link #protect(org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy) protect(ProtectionPolicy)}),                          
</span><span class="outsideLine"><i>1350</i>      * do not use the document after saving because the contents are now encrypted.                                                 
</span><span class="outsideLine"><i>1351</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1352</i>      * @param output The stream to write to. It will be closed when done. It is recommended to wrap                                 
</span><span class="outsideLine"><i>1353</i>      * it in a {@link java.io.BufferedOutputStream}, unless it is already buffered.                                                 
</span><span class="outsideLine"><i>1354</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1355</i>      * @throws IOException if the output could not be written                                                                       
</span><span class="outsideLine"><i>1356</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1357</i>     public void save(OutputStream output) throws IOException                                                                        
</span><span class="methodLine"><i>1358</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1727</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1359</i>         if (document.isClosed())                                                                                                    
</span><span class="methodLine"><i>1360</i>         {                                                                                                                           
</span><span class="methodLine"><i>1361</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7714</span>new IOException("Cannot save a document which has been closed")</span>;                                                  
</span><span class="methodLine"><i>1362</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1363</i>                                                                                                                                     
</span><span class="outsideLine"><i>1364</i>         // subset designated fonts                                                                                                  
</span><span class="methodLine"><i>1365</i>         for (PDFont font : fontsToSubset)                                                                                           
</span><span class="methodLine"><i>1366</i>         {                                                                                                                           
</span><span class="methodLine"><i>1367</i>             font.subset();                                                                                                          
</span><span class="methodLine"><i>1368</i>         }                                                                                                                           
</span><span class="methodLine"><i>1369</i>         fontsToSubset.clear();                                                                                                      
</span><span class="outsideLine"><i>1370</i>                                                                                                                                     
</span><span class="outsideLine"><i>1371</i>         // save PDF                                                                                                                 
</span><span class="methodLine"><i>1372</i>         COSWriter writer = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7718</span>new COSWriter(output)</span>;                                                                                   
</span><span class="methodLine"><i>1373</i>         try                                                                                                                         
</span><span class="methodLine"><i>1374</i>         {                                                                                                                           
</span><span class="methodLine"><i>1375</i>             writer.write(this);                                                                                                     
</span><span class="methodLine"><i>1376</i>         }                                                                                                                           
</span><span class="methodLine"><i>1377</i>         finally                                                                                                                     
</span><span class="methodLine"><i>1378</i>         {                                                                                                                           
</span><span class="methodLine"><i>1379</i>             writer.close();                                                                                                         
</span><span class="methodLine"><i>1380</i>         }                                                                                                                           
</span><span class="methodLine"><i>1381</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1382</i>                                                                                                                                     
</span><span class="outsideLine"><i>1383</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1384</i>      * Save the PDF as an incremental update. This is only possible if the PDF was loaded from a                                    
</span><span class="outsideLine"><i>1385</i>      * file or a stream, not if the document was created in PDFBox itself. There must be a path of                                  
</span><span class="outsideLine"><i>1386</i>      * objects that have {@link COSUpdateInfo#isNeedToBeUpdated()} set, starting from the document                                  
</span><span class="outsideLine"><i>1387</i>      * catalog. For signatures this is taken care by PDFBox itself.                                                                 
</span><span class="outsideLine"><i>1388</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1389</i>      * Other usages of this method are for experienced users only. You will usually never need it.                                  
</span><span class="outsideLine"><i>1390</i>      * It is useful only if you are required to keep the current revision and append the changes. A                                 
</span><span class="outsideLine"><i>1391</i>      * typical use case is changing a signed file without invalidating the signature.                                               
</span><span class="outsideLine"><i>1392</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1393</i>      * @param output stream to write to. It will be closed when done. It                                                            
</span><span class="outsideLine"><i>1394</i>      * <i><b>must never</b></i> point to the source file or that one will be                                                        
</span><span class="outsideLine"><i>1395</i>      * harmed!                                                                                                                      
</span><span class="outsideLine"><i>1396</i>      * @throws IOException if the output could not be written                                                                       
</span><span class="outsideLine"><i>1397</i>      * @throws IllegalStateException if the document was not loaded from a file or a stream.                                        
</span><span class="outsideLine"><i>1398</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1399</i>                                                                                                                                     
</span><span class="outsideLine"><i>1400</i>     public void saveIncremental(OutputStream output) throws IOException                                                             
</span><span class="methodLine"><i>1401</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1734</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1402</i>         COSWriter writer = null;                                                                                                    
</span><span class="methodLine"><i>1403</i>         try                                                                                                                         
</span><span class="methodLine"><i>1404</i>         {                                                                                                                           
</span><span class="methodLine"><i>1405</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7052</span>pdfSource <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7052</span>==</span> null</span>)                                                                                                  
</span><span class="methodLine"><i>1406</i>             {                                                                                                                       
</span><span class="methodLine"><i>1407</i>                 throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9503</span>new IllegalStateException("document was not loaded from a file or a stream")</span>;                                 
</span><span class="methodLine"><i>1408</i>             }                                                                                                                       
</span><span class="methodLine"><i>1409</i>             writer = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8393</span>new COSWriter(output, pdfSource)</span>;                                                                              
</span><span class="methodLine"><i>1410</i>             writer.write(this, signInterface);                                                                                      
</span><span class="methodLine"><i>1411</i>         }                                                                                                                           
</span><span class="methodLine"><i>1412</i>         finally                                                                                                                     
</span><span class="methodLine"><i>1413</i>         {                                                                                                                           
</span><span class="methodLine"><i>1414</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7739</span>writer <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7739</span>!=</span> null</span>)                                                                                                     
</span><span class="methodLine"><i>1415</i>             {                                                                                                                       
</span><span class="methodLine"><i>1416</i>                 writer.close();                                                                                                     
</span><span class="methodLine"><i>1417</i>             }                                                                                                                       
</span><span class="methodLine"><i>1418</i>         }                                                                                                                           
</span><span class="methodLine"><i>1419</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1420</i>                                                                                                                                     
</span><span class="outsideLine"><i>1421</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1422</i>      * Save the PDF as an incremental update. This is only possible if the PDF was loaded from a                                    
</span><span class="outsideLine"><i>1423</i>      * file or a stream, not if the document was created in PDFBox itself. This allows to include                                   
</span><span class="outsideLine"><i>1424</i>      * objects even if there is no path of objects that have                                                                        
</span><span class="outsideLine"><i>1425</i>      * {@link COSUpdateInfo#isNeedToBeUpdated()} set so the incremental update gets smaller. Only                                   
</span><span class="outsideLine"><i>1426</i>      * dictionaries are supported; if you need to update other objects classes, then add their                                      
</span><span class="outsideLine"><i>1427</i>      * parent dictionary.                                                                                                           
</span><span class="outsideLine"><i>1428</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1429</i>      * This method is for experienced users only. You will usually never need it. It is useful only                                 
</span><span class="outsideLine"><i>1430</i>      * if you are required to keep the current revision and append the changes. A typical use case                                  
</span><span class="outsideLine"><i>1431</i>      * is changing a signed file without invalidating the signature. To know which objects are                                      
</span><span class="outsideLine"><i>1432</i>      * getting changed, you need to have some understanding of the PDF specification, and look at                                   
</span><span class="outsideLine"><i>1433</i>      * the saved file with an editor to verify that you are updating the correct objects. You should                                
</span><span class="outsideLine"><i>1434</i>      * also inspect the page and document structures of the file with PDFDebugger.                                                  
</span><span class="outsideLine"><i>1435</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1436</i>      * @param output stream to write to. It will be closed when done. It                                                            
</span><span class="outsideLine"><i>1437</i>      * <i><b>must never</b></i> point to the source file or that one will be harmed!                                                
</span><span class="outsideLine"><i>1438</i>      * @param objectsToWrite objects that <b>must</b> be part of the incremental saving.                                            
</span><span class="outsideLine"><i>1439</i>      * @throws IOException if the output could not be written                                                                       
</span><span class="outsideLine"><i>1440</i>      * @throws IllegalStateException if the document was not loaded from a file or a stream.                                        
</span><span class="outsideLine"><i>1441</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1442</i>     public void saveIncremental(OutputStream output, Set<COSDictionary> objectsToWrite) throws IOException                          
</span><span class="methodLine"><i>1443</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1741</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1444</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4557</span>pdfSource <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4557</span>==</span> null</span>)                                                                                                      
</span><span class="methodLine"><i>1445</i>         {                                                                                                                           
</span><span class="methodLine"><i>1446</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7745</span>new IllegalStateException("document was not loaded from a file or a stream")</span>;                                     
</span><span class="methodLine"><i>1447</i>         }                                                                                                                           
</span><span class="methodLine"><i>1448</i>         COSWriter writer = null;                                                                                                    
</span><span class="methodLine"><i>1449</i>         try                                                                                                                         
</span><span class="methodLine"><i>1450</i>         {                                                                                                                           
</span><span class="methodLine"><i>1451</i>             writer = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 8412</span>new COSWriter(output, pdfSource, objectsToWrite)</span>;                                                              
</span><span class="methodLine"><i>1452</i>             writer.write(this, signInterface);                                                                                      
</span><span class="methodLine"><i>1453</i>         }                                                                                                                           
</span><span class="methodLine"><i>1454</i>         finally                                                                                                                     
</span><span class="methodLine"><i>1455</i>         {                                                                                                                           
</span><span class="methodLine"><i>1456</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7755</span>writer <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7755</span>!=</span> null</span>)                                                                                                     
</span><span class="methodLine"><i>1457</i>             {                                                                                                                       
</span><span class="methodLine"><i>1458</i>                 writer.close();                                                                                                     
</span><span class="methodLine"><i>1459</i>             }                                                                                                                       
</span><span class="methodLine"><i>1460</i>         }                                                                                                                           
</span><span class="methodLine"><i>1461</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1462</i>                                                                                                                                     
</span><span class="outsideLine"><i>1463</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1464</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1465</i>      * <b>(This is a new feature for 2.0.3. The API for external signing might change based on feedback after release!)</b>         
</span><span class="outsideLine"><i>1466</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1467</i>      * Save PDF incrementally without closing for external signature creation scenario. The general                                 
</span><span class="outsideLine"><i>1468</i>      * sequence is:                                                                                                                 
</span><span class="outsideLine"><i>1469</i>      * <pre>                                                                                                                        
</span><span class="outsideLine"><i>1470</i>      *    PDDocument pdDocument = ...;                                                                                              
</span><span class="outsideLine"><i>1471</i>      *    OutputStream outputStream = ...;                                                                                          
</span><span class="outsideLine"><i>1472</i>      *    SignatureOptions signatureOptions = ...; // options to specify fine tuned signature options or null for defaults          
</span><span class="outsideLine"><i>1473</i>      *    PDSignature pdSignature = ...;                                                                                            
</span><span class="outsideLine"><i>1474</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1475</i>      *    // add signature parameters to be used when creating signature dictionary                                                 
</span><span class="outsideLine"><i>1476</i>      *    pdDocument.addSignature(pdSignature, signatureOptions);                                                                   
</span><span class="outsideLine"><i>1477</i>      *    // prepare PDF for signing and obtain helper class to be used                                                             
</span><span class="outsideLine"><i>1478</i>      *    ExternalSigningSupport externalSigningSupport = pdDocument.saveIncrementalForExternalSigning(outputStream);               
</span><span class="outsideLine"><i>1479</i>      *    // get data to be signed                                                                                                  
</span><span class="outsideLine"><i>1480</i>      *    InputStream dataToBeSigned = externalSigningSupport.getContent();                                                         
</span><span class="outsideLine"><i>1481</i>      *    // invoke signature service                                                                                               
</span><span class="outsideLine"><i>1482</i>      *    byte[] signature = sign(dataToBeSigned);                                                                                  
</span><span class="outsideLine"><i>1483</i>      *    // set resulted CMS signature                                                                                             
</span><span class="outsideLine"><i>1484</i>      *    externalSigningSupport.setSignature(signature);                                                                           
</span><span class="outsideLine"><i>1485</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1486</i>      *    // last step is to close the document                                                                                     
</span><span class="outsideLine"><i>1487</i>      *    pdDocument.close();                                                                                                       
</span><span class="outsideLine"><i>1488</i>      * </pre>                                                                                                                       
</span><span class="outsideLine"><i>1489</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1490</i>      * Note that after calling this method, only {@code close()} method may invoked for                                             
</span><span class="outsideLine"><i>1491</i>      * {@code PDDocument} instance and only AFTER {@link ExternalSigningSupport} instance is used.                                  
</span><span class="outsideLine"><i>1492</i>      * </p>                                                                                                                         
</span><span class="outsideLine"><i>1493</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1494</i>      * @param output stream to write the final PDF. It will be closed when the                                                      
</span><span class="outsideLine"><i>1495</i>      * document is closed. It <i><b>must never</b></i> point to the source file                                                     
</span><span class="outsideLine"><i>1496</i>      * or that one will be harmed!                                                                                                  
</span><span class="outsideLine"><i>1497</i>      * @return instance to be used for external signing and setting CMS signature                                                   
</span><span class="outsideLine"><i>1498</i>      * @throws IOException if the output could not be written                                                                       
</span><span class="outsideLine"><i>1499</i>      * @throws IllegalStateException if the document was not loaded from a file or a stream or                                      
</span><span class="outsideLine"><i>1500</i>      * signature options were not set.                                                                                              
</span><span class="outsideLine"><i>1501</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1502</i>     public ExternalSigningSupport saveIncrementalForExternalSigning(OutputStream output) throws IOException                         
</span><span class="methodLine"><i>1503</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1748</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1504</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4570</span>pdfSource <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4570</span>==</span> null</span>)                                                                                                      
</span><span class="methodLine"><i>1505</i>         {                                                                                                                           
</span><span class="methodLine"><i>1506</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7760</span>new IllegalStateException("document was not loaded from a file or a stream")</span>;                                     
</span><span class="methodLine"><i>1507</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1508</i>         // PDFBOX-3978: getLastSignatureDictionary() not helpful if signing into a template                                         
</span><span class="outsideLine"><i>1509</i>         // that is not the last signature. So give higher priority to signature with update flag.                                   
</span><span class="methodLine"><i>1510</i>         PDSignature foundSignature = null;                                                                                          
</span><span class="methodLine"><i>1511</i>         for (PDSignature sig : getSignatureDictionaries())                                                                          
</span><span class="methodLine"><i>1512</i>         {                                                                                                                           
</span><span class="methodLine"><i>1513</i>             foundSignature = sig;                                                                                                   
</span><span class="methodLine"><i>1514</i>             if (sig.getCOSObject().isNeedToBeUpdated())                                                                             
</span><span class="methodLine"><i>1515</i>             {                                                                                                                       
</span><span class="methodLine"><i>1516</i>                 break;                                                                                                              
</span><span class="methodLine"><i>1517</i>             }                                                                                                                       
</span><span class="methodLine"><i>1518</i>         }                                                                                                                           
</span><span class="methodLine"><i>1519</i>         int[] byteRange = foundSignature.getByteRange();                                                                            
</span><span class="methodLine"><i>1520</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4580</span>!</span>Arrays.equals(byteRange, RESERVE_BYTE_RANGE))                                                                          
</span><span class="methodLine"><i>1521</i>         {                                                                                                                           
</span><span class="methodLine"><i>1522</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7775</span>new IllegalStateException("signature reserve byte range has been changed "                                        
</span><span class="methodLine"><i>1523</i>                     + "after addSignature(), please set the byte range that existed after addSignature()")</span>;                         
</span><span class="methodLine"><i>1524</i>         }                                                                                                                           
</span><span class="methodLine"><i>1525</i>         COSWriter writer = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7777</span>new COSWriter(output, pdfSource)</span>;                                                                        
</span><span class="methodLine"><i>1526</i>         writer.write(this);                                                                                                         
</span><span class="methodLine"><i>1527</i>         signingSupport = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 6314</span>new SigningSupport(writer)</span>;                                                                                
</span><span class="methodLine"><i>1528</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3267</span>return signingSupport;</span>                                                                                                      
</span><span class="methodLine"><i>1529</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1530</i>                                                                                                                                     
</span><span class="outsideLine"><i>1531</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1532</i>      * Returns the page at the given 0-based index.                                                                                 
</span><span class="outsideLine"><i>1533</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1534</i>      * This method is too slow to get all the pages from a large PDF document                                                       
</span><span class="outsideLine"><i>1535</i>      * (1000 pages or more). For such documents, use the iterator of                                                                
</span><span class="outsideLine"><i>1536</i>      * {@link PDDocument#getPages()} instead.                                                                                       
</span><span class="outsideLine"><i>1537</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1538</i>      * @param pageIndex the 0-based page index                                                                                      
</span><span class="outsideLine"><i>1539</i>      * @return the page at the given index.                                                                                         
</span><span class="outsideLine"><i>1540</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1541</i>     public PDPage getPage(int pageIndex) // todo: REPLACE most calls to this method with BELOW method                               
</span><span class="methodLine"><i>1542</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1753</span>{                                                                                                                               
</span><span class="methodLine"><i>1543</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3270</span>return getDocumentCatalog().getPages().get(pageIndex);</span>                                                                      
</span><span class="methodLine"><i>1544</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1545</i>                                                                                                                                     
</span><span class="outsideLine"><i>1546</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1547</i>      * Returns the page tree.                                                                                                       
</span><span class="outsideLine"><i>1548</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1549</i>      * @return the page tree                                                                                                        
</span><span class="outsideLine"><i>1550</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1551</i>     public PDPageTree getPages()                                                                                                    
</span><span class="methodLine"><i>1552</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1758</span>{                                                                                                                               
</span><span class="methodLine"><i>1553</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3271</span>return getDocumentCatalog().getPages();</span>                                                                                     
</span><span class="methodLine"><i>1554</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1555</i>                                                                                                                                     
</span><span class="outsideLine"><i>1556</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1557</i>      * This will return the total page count of the PDF document.                                                                   
</span><span class="outsideLine"><i>1558</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1559</i>      * @return The total number of pages in the PDF document.                                                                       
</span><span class="outsideLine"><i>1560</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1561</i>     public int getNumberOfPages()                                                                                                   
</span><span class="methodLine"><i>1562</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return 1;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1763</span>{                                                                                                                               
</span><span class="methodLine"><i>1563</i>         return getDocumentCatalog().getPages().getCount();                                                                          
</span><span class="methodLine"><i>1564</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1565</i>                                                                                                                                     
</span><span class="outsideLine"><i>1566</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1567</i>      * This will close the underlying COSDocument object.                                                                           
</span><span class="outsideLine"><i>1568</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1569</i>      * @throws IOException If there is an error releasing resources.                                                                
</span><span class="outsideLine"><i>1570</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1571</i>     @Override                                                                                                                       
</span><span class="outsideLine"><i>1572</i>     public void close() throws IOException                                                                                          
</span><span class="methodLine"><i>1573</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1771</span>{                                                                                                                               
</span><span class="methodLine"><i>1574</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4600</span>!</span>document.isClosed())                                                                                                   
</span><span class="methodLine"><i>1575</i>         {                                                                                                                           
</span><span class="outsideLine"><i>1576</i>             // Make sure that:                                                                                                      
</span><span class="outsideLine"><i>1577</i>             // - first Exception is kept                                                                                            
</span><span class="outsideLine"><i>1578</i>             // - all IO resources are closed                                                                                        
</span><span class="outsideLine"><i>1579</i>             // - there's a way to see which errors occurred                                                                         
</span><span class="outsideLine"><i>1580</i>                                                                                                                                     
</span><span class="methodLine"><i>1581</i>             IOException firstException = null;                                                                                      
</span><span class="outsideLine"><i>1582</i>                                                                                                                                     
</span><span class="outsideLine"><i>1583</i>             // close resources and COSWriter                                                                                        
</span><span class="methodLine"><i>1584</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7793</span>signingSupport <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7793</span>!=</span> null</span>)                                                                                             
</span><span class="methodLine"><i>1585</i>             {                                                                                                                       
</span><span class="methodLine"><i>1586</i>                 firstException = IOUtils.closeAndLogException(signingSupport, LOG, "SigningSupport", firstException);               
</span><span class="methodLine"><i>1587</i>             }                                                                                                                       
</span><span class="outsideLine"><i>1588</i>                                                                                                                                     
</span><span class="outsideLine"><i>1589</i>             // close all intermediate I/O streams                                                                                   
</span><span class="methodLine"><i>1590</i>             firstException = IOUtils.closeAndLogException(document, LOG, "COSDocument", firstException);                            
</span><span class="outsideLine"><i>1591</i>                                                                                                                                     
</span><span class="outsideLine"><i>1592</i>             // close the source PDF stream, if we read from one                                                                     
</span><span class="methodLine"><i>1593</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7798</span>pdfSource <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7798</span>!=</span> null</span>)                                                                                                  
</span><span class="methodLine"><i>1594</i>             {                                                                                                                       
</span><span class="methodLine"><i>1595</i>                 firstException = IOUtils.closeAndLogException(pdfSource, LOG, "RandomAccessRead pdfSource", firstException);        
</span><span class="methodLine"><i>1596</i>             }                                                                                                                       
</span><span class="outsideLine"><i>1597</i>                                                                                                                                     
</span><span class="outsideLine"><i>1598</i>             // close fonts                                                                                                          
</span><span class="methodLine"><i>1599</i>             for (TrueTypeFont ttf : fontsToClose)                                                                                   
</span><span class="methodLine"><i>1600</i>             {                                                                                                                       
</span><span class="methodLine"><i>1601</i>                 firstException = IOUtils.closeAndLogException(ttf, LOG, "TrueTypeFont", firstException);                            
</span><span class="methodLine"><i>1602</i>             }                                                                                                                       
</span><span class="outsideLine"><i>1603</i>                                                                                                                                     
</span><span class="outsideLine"><i>1604</i>             // rethrow first exception to keep method contract                                                                      
</span><span class="methodLine"><i>1605</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7804</span>firstException <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7804</span>!=</span> null</span>)                                                                                             
</span><span class="methodLine"><i>1606</i>             {                                                                                                                       
</span><span class="methodLine"><i>1607</i>                 throw firstException;                                                                                               
</span><span class="methodLine"><i>1608</i>             }                                                                                                                       
</span><span class="methodLine"><i>1609</i>         }                                                                                                                           
</span><span class="methodLine"><i>1610</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1611</i>                                                                                                                                     
</span><span class="outsideLine"><i>1612</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1613</i>      * Protects the document with a protection policy. The document content will be really                                          
</span><span class="outsideLine"><i>1614</i>      * encrypted when it will be saved. This method only marks the document for encryption. It also                                 
</span><span class="outsideLine"><i>1615</i>      * calls {@link #setAllSecurityToBeRemoved(boolean)} with a false argument if it was set to true                                
</span><span class="outsideLine"><i>1616</i>      * previously and logs a warning.                                                                                               
</span><span class="outsideLine"><i>1617</i>      * <p>                                                                                                                          
</span><span class="outsideLine"><i>1618</i>      * Do not use the document after saving, because the structures are encrypted.                                                  
</span><span class="outsideLine"><i>1619</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1620</i>      * @see org.apache.pdfbox.pdmodel.encryption.StandardProtectionPolicy                                                           
</span><span class="outsideLine"><i>1621</i>      * @see org.apache.pdfbox.pdmodel.encryption.PublicKeyProtectionPolicy                                                          
</span><span class="outsideLine"><i>1622</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1623</i>      * @param policy The protection policy.                                                                                         
</span><span class="outsideLine"><i>1624</i>      * @throws IOException if there isn't any suitable security handler.                                                            
</span><span class="outsideLine"><i>1625</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1626</i>     public void protect(ProtectionPolicy policy) throws IOException                                                                 
</span><span class="methodLine"><i>1627</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1778</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1628</i>         if (isAllSecurityToBeRemoved())                                                                                             
</span><span class="methodLine"><i>1629</i>         {                                                                                                                           
</span><span class="methodLine"><i>1630</i>             LOG.warn("do not call setAllSecurityToBeRemoved(true) before calling protect(), "                                       
</span><span class="methodLine"><i>1631</i>                     + "as protect() implies setAllSecurityToBeRemoved(false)");                                                     
</span><span class="methodLine"><i>1632</i>             setAllSecurityToBeRemoved(false);                                                                                       
</span><span class="methodLine"><i>1633</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1634</i>                                                                                                                                     
</span><span class="methodLine"><i>1635</i>         if (<span class="ConditionalOperatorDeletion tooltip"><span class="tooltiptext">Mutated Text:   
Mutation Operator Type: ConditionalOperatorDeletion 
Node ID: 4609</span>!</span>isEncrypted())                                                                                                         
</span><span class="methodLine"><i>1636</i>         {                                                                                                                           
</span><span class="methodLine"><i>1637</i>             encryption = <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 9071</span>new PDEncryption()</span>;                                                                                        
</span><span class="methodLine"><i>1638</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1639</i>                                                                                                                                     
</span><span class="methodLine"><i>1640</i>         SecurityHandler securityHandler = SecurityHandlerFactory.INSTANCE.newSecurityHandlerForPolicy(policy);                      
</span><span class="methodLine"><i>1641</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4615</span>securityHandler <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4615</span>==</span> null</span>)                                                                                                
</span><span class="methodLine"><i>1642</i>         {                                                                                                                           
</span><span class="methodLine"><i>1643</i>             throw <span class="NullifyObjectInitialization tooltip"><span class="tooltiptext">Mutated Text: null 
Mutation Operator Type: NullifyObjectInitialization 
Node ID: 7817</span>new IOException("No security handler for policy " + policy)</span>;                                                      
</span><span class="methodLine"><i>1644</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1645</i>                                                                                                                                     
</span><span class="methodLine"><i>1646</i>         getEncryption().setSecurityHandler(securityHandler);                                                                        
</span><span class="methodLine"><i>1647</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1648</i>                                                                                                                                     
</span><span class="outsideLine"><i>1649</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1650</i>      * Returns the access permissions granted when the document was decrypted. If the document was not decrypted this               
</span><span class="outsideLine"><i>1651</i>      * method returns the access permission for a document owner (ie can do everything). The returned object is in read             
</span><span class="outsideLine"><i>1652</i>      * only mode so that permissions cannot be changed. Methods providing access to content should rely on this object              
</span><span class="outsideLine"><i>1653</i>      * to verify if the current user is allowed to proceed.                                                                         
</span><span class="outsideLine"><i>1654</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1655</i>      * @return the access permissions for the current user on the document.                                                         
</span><span class="outsideLine"><i>1656</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1657</i>     public AccessPermission getCurrentAccessPermission()                                                                            
</span><span class="methodLine"><i>1658</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1783</span>{                                                                                                                               
</span><span class="methodLine"><i>1659</i>         if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: false 
Mutation Operator Type: RemoveNullCheck 
Node ID: 4620</span>accessPermission <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4620</span>==</span> null</span>)                                                                                               
</span><span class="methodLine"><i>1660</i>         {                                                                                                                           
</span><span class="methodLine"><i>1661</i>             accessPermission = AccessPermission.getOwnerAccessPermission();                                                         
</span><span class="methodLine"><i>1662</i>         }                                                                                                                           
</span><span class="methodLine"><i>1663</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3283</span>return accessPermission;</span>                                                                                                    
</span><span class="methodLine"><i>1664</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1665</i>                                                                                                                                     
</span><span class="outsideLine"><i>1666</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1667</i>      * Indicates if all security is removed or not when writing the pdf.                                                            
</span><span class="outsideLine"><i>1668</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1669</i>      * @return returns true if all security shall be removed otherwise false                                                        
</span><span class="outsideLine"><i>1670</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1671</i>     public boolean isAllSecurityToBeRemoved()                                                                                       
</span><span class="methodLine"><i>1672</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return false;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1788</span>{                                                                                                                               
</span><span class="methodLine"><i>1673</i>         return allSecurityToBeRemoved;                                                                                              
</span><span class="methodLine"><i>1674</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1675</i>                                                                                                                                     
</span><span class="outsideLine"><i>1676</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1677</i>      * Activates/Deactivates the removal of all security when writing the pdf.                                                      
</span><span class="outsideLine"><i>1678</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1679</i>      * @param removeAllSecurity remove all security if set to true                                                                  
</span><span class="outsideLine"><i>1680</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1681</i>     public void setAllSecurityToBeRemoved(boolean removeAllSecurity)                                                                
</span><span class="methodLine"><i>1682</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1793</span>{                                                                                                                               
</span><span class="methodLine"><i>1683</i>         allSecurityToBeRemoved = removeAllSecurity;                                                                                 
</span><span class="methodLine"><i>1684</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1685</i>                                                                                                                                     
</span><span class="outsideLine"><i>1686</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1687</i>      * Provides the document ID.                                                                                                    
</span><span class="outsideLine"><i>1688</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1689</i>      * @return the document ID                                                                                                      
</span><span class="outsideLine"><i>1690</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1691</i>     public Long getDocumentId()                                                                                                     
</span><span class="methodLine"><i>1692</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1798</span>{                                                                                                                               
</span><span class="methodLine"><i>1693</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3288</span>return documentId;</span>                                                                                                          
</span><span class="methodLine"><i>1694</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1695</i>                                                                                                                                     
</span><span class="outsideLine"><i>1696</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1697</i>      * Sets the document ID to the given value.                                                                                     
</span><span class="outsideLine"><i>1698</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1699</i>      * @param docId the new document ID                                                                                             
</span><span class="outsideLine"><i>1700</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1701</i>     public void setDocumentId(Long docId)                                                                                           
</span><span class="methodLine"><i>1702</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1803</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1703</i>         documentId = docId;                                                                                                         
</span><span class="methodLine"><i>1704</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1705</i>                                                                                                                                     
</span><span class="outsideLine"><i>1706</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1707</i>      * Returns the PDF specification version this document conforms to.                                                             
</span><span class="outsideLine"><i>1708</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1709</i>      * @return the PDF version (e.g. 1.4f)                                                                                          
</span><span class="outsideLine"><i>1710</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1711</i>     public float getVersion()                                                                                                       
</span><span class="methodLine"><i>1712</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return 0.1F;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1808</span>{                                                                                                                               
</span><span class="methodLine"><i>1713</i>         float headerVersionFloat = getDocument().getVersion();                                                                      
</span><span class="outsideLine"><i>1714</i>         // there may be a second version information in the document catalog starting with 1.4                                      
</span><span class="methodLine"><i>1715</i>         if (headerVersionFloat <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: < 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4633</span>>=</span> 1.4f)                                                                                             
</span><span class="methodLine"><i>1716</i>         {                                                                                                                           
</span><span class="methodLine"><i>1717</i>             String catalogVersion = getDocumentCatalog().getVersion();                                                              
</span><span class="methodLine"><i>1718</i>             float catalogVersionFloat = <span class="ArithmeticOperatorReplacementUnary tooltip"><span class="tooltiptext">Mutated Text: + 
Mutation Operator Type: ArithmeticOperatorReplacementUnary 
Node ID: 9595</span>-</span>1;                                                                                         
</span><span class="methodLine"><i>1719</i>             if (<span class="RemoveNullCheck tooltip"><span class="tooltiptext">Mutated Text: true 
Mutation Operator Type: RemoveNullCheck 
Node ID: 7831</span>catalogVersion <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: == 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 7831</span>!=</span> null</span>)                                                                                             
</span><span class="methodLine"><i>1720</i>             {                                                                                                                       
</span><span class="methodLine"><i>1721</i>                 try                                                                                                                 
</span><span class="methodLine"><i>1722</i>                 {                                                                                                                   
</span><span class="methodLine"><i>1723</i>                     catalogVersionFloat = Float.parseFloat(catalogVersion);                                                         
</span><span class="methodLine"><i>1724</i>                 }                                                                                                                   
</span><span class="methodLine"><i>1725</i>                 catch(NumberFormatException exception)                                                                              
</span><span class="methodLine"><i>1726</i>                 {                                                                                                                   
</span><span class="methodLine"><i>1727</i>                     LOG.error("Can't extract the version number of the document catalog.", exception);                              
</span><span class="methodLine"><i>1728</i>                 }                                                                                                                   
</span><span class="methodLine"><i>1729</i>             }                                                                                                                       
</span><span class="outsideLine"><i>1730</i>             // the most recent version is the correct one                                                                           
</span><span class="methodLine"><i>1731</i>             return Math.max(catalogVersionFloat, headerVersionFloat);                                                               
</span><span class="methodLine"><i>1732</i>         }                                                                                                                           
</span><span class="methodLine"><i>1733</i>         else                                                                                                                        
</span><span class="methodLine"><i>1734</i>         {                                                                                                                           
</span><span class="methodLine"><i>1735</i>             return headerVersionFloat;                                                                                              
</span><span class="methodLine"><i>1736</i>         }                                                                                                                           
</span><span class="methodLine"><i>1737</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1738</i>                                                                                                                                     
</span><span class="outsideLine"><i>1739</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1740</i>      * Sets the PDF specification version for this document.                                                                        
</span><span class="outsideLine"><i>1741</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1742</i>      * @param newVersion the new PDF version (e.g. 1.4f)                                                                            
</span><span class="outsideLine"><i>1743</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1744</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1745</i>     public void setVersion(float newVersion)                                                                                        
</span><span class="methodLine"><i>1746</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1813</span>{                                                                                                                               
</span><span class="methodLine"><i>1747</i>         float currentVersion = getVersion();                                                                                        
</span><span class="outsideLine"><i>1748</i>         // nothing to do?                                                                                                           
</span><span class="methodLine"><i>1749</i>         if (newVersion <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: != 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4641</span>==</span> currentVersion)                                                                                           
</span><span class="methodLine"><i>1750</i>         {                                                                                                                           
</span><span class="methodLine"><i>1751</i>             return;                                                                                                                 
</span><span class="methodLine"><i>1752</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1753</i>         // the version can't be downgraded                                                                                          
</span><span class="methodLine"><i>1754</i>         if (newVersion <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: >= 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4645</span><</span> currentVersion)                                                                                            
</span><span class="methodLine"><i>1755</i>         {                                                                                                                           
</span><span class="methodLine"><i>1756</i>             LOG.error("It's not allowed to downgrade the version of a pdf.");                                                       
</span><span class="methodLine"><i>1757</i>             return;                                                                                                                 
</span><span class="methodLine"><i>1758</i>         }                                                                                                                           
</span><span class="outsideLine"><i>1759</i>         // update the catalog version if the document version is >= 1.4                                                             
</span><span class="methodLine"><i>1760</i>         if (getDocument().getVersion() <span class="RelationalOperatorReplacement tooltip"><span class="tooltiptext">Mutated Text: < 
Mutation Operator Type: RelationalOperatorReplacement 
Node ID: 4649</span>>=</span> 1.4f)                                                                                     
</span><span class="methodLine"><i>1761</i>         {                                                                                                                           
</span><span class="methodLine"><i>1762</i>             getDocumentCatalog().setVersion(Float.toString(newVersion));                                                            
</span><span class="methodLine"><i>1763</i>         }                                                                                                                           
</span><span class="methodLine"><i>1764</i>         else                                                                                                                        
</span><span class="methodLine"><i>1765</i>         {                                                                                                                           
</span><span class="outsideLine"><i>1766</i>             // versions < 1.4f have a version header only                                                                           
</span><span class="methodLine"><i>1767</i>             getDocument().setVersion(newVersion);                                                                                   
</span><span class="methodLine"><i>1768</i>         }                                                                                                                           
</span><span class="methodLine"><i>1769</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1770</i>                                                                                                                                     
</span><span class="outsideLine"><i>1771</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1772</i>      * Returns the resource cache associated with this document, or null if there is none.                                          
</span><span class="outsideLine"><i>1773</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1774</i>      * @return the resource cache or null.                                                                                          
</span><span class="outsideLine"><i>1775</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1776</i>     public ResourceCache getResourceCache()                                                                                         
</span><span class="methodLine"><i>1777</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
    return null;
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1818</span>{                                                                                                                               
</span><span class="methodLine"><i>1778</i>         <span class="NullifyReturnValue tooltip"><span class="tooltiptext">Mutated Text: return null; 
Mutation Operator Type: NullifyReturnValue 
Node ID: 3300</span>return resourceCache;</span>                                                                                                       
</span><span class="methodLine"><i>1779</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1780</i>                                                                                                                                     
</span><span class="outsideLine"><i>1781</i>     /**                                                                                                                             
</span><span class="outsideLine"><i>1782</i>      * Sets the resource cache associated with this document.                                                                       
</span><span class="outsideLine"><i>1783</i>      *                                                                                                                              
</span><span class="outsideLine"><i>1784</i>      * @param resourceCache A resource cache, or null.                                                                              
</span><span class="outsideLine"><i>1785</i>      */                                                                                                                             
</span><span class="outsideLine"><i>1786</i>     public void setResourceCache(ResourceCache resourceCache)                                                                       
</span><span class="methodLine"><i>1787</i>     <span class="RemoveMethod tooltip"><span class="tooltiptext">Mutated Text: {
// void -- no return //
}
 
Mutation Operator Type: RemoveMethod 
Node ID: 1823</span>{</span>                                                                                                                               
</span><span class="methodLine"><i>1788</i>         this.resourceCache = resourceCache;                                                                                         
</span><span class="methodLine"><i>1789</i>     }</span>                                                                                                                               
</span><span class="outsideLine"><i>1790</i> }                                                                                                                                   
</span><span class="outsideLine"><i>1791</i>                                                                                                                                     </pre></div><footer><p style="font-size: small">Report generated by LittleDarwin 0.10.7 </p></footer></body></html>